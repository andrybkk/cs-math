#import "@preview/cetz:0.3.2"

#set page(
  paper: "a4", 
  margin: (x: 2cm, y: 2.5cm), 
  numbering: "1 / 1"
)

#set text(
  font: "New Computer Modern",
  size: 13pt,
  lang: "ru"
)

#set par(
  justify: true,
  leading: 0.65em
)

#show heading: set text(fill: blue.darken(20%))
#show heading: set text(weight: "bold")

#show heading.where(level: 1): it => [
  #set text(size: 24pt)
  #v(1em)
  #it
  #v(-20pt)
  #line(length: 100%, stroke: 1pt + blue.darken(20%))
]

#show heading.where(level: 2): set text(size: 18pt)

#let note(title, body) = rect(
  fill: blue.lighten(90%),
  stroke: blue.darken(20%) + 1pt,
  radius: 4pt,
  width: 100%,
  inset: 12pt
)[
  *#title* \
  #body
]

#let ax(id, body) = grid(
  columns: (30pt, 1fr),
  gutter: 10pt,
  v(0em) + [*#id*],
  body
)

#let axiom_block(title, content) = block(
  width: 100%,
  stroke: 0.5pt + gray,
  radius: 3pt,
  inset: 12pt,
  fill: rgb("#fafafa")
)[
  #set text(size: 11pt)
  #align(center)[#text(weight: "bold", size: 13pt)[#title]]
  #v(0.4em)
  #content
]

#let definition(body) = note("Определение", body)
#let theorem(body) = note("Теорема", body)
#let lemma(body) = note("Лемма", body)
#let proof(body) = block(spacing: 1.2em, inset: (left: 1em))[
  _Доказательство._ #body #h(1fr) $qed$
]

#let Arg = math.op("Arg")
#let arg = math.op("arg")
#let Re = math.op("Re")
#let Im = math.op("Im")
#let sgn = math.op("sgn")

= Матан

== Вещественные числа

#definition[
  *Множество вещественных (действительных) чисел* $RR$ — это математическая абстракция, представляющая собой совокупность всех возможных значений длин отрезков, их координат на прямой, а также предельных значений рациональных чисел.
]

В курсе анализа вещественные числа вводятся либо аксиоматически (как полное упорядоченное поле), либо конструктивно (через сечения Дедекинда или фундаментальные последовательности Кантора). 

Множество $RR$ включает в себя:
- Натуральные числа: $NN = {1, 2, 3, dots}$
- Целые числа: $ZZ = {dots, -2, -1, 0, 1, 2, dots}$
- Рациональные числа: $QQ = {p/q : p in ZZ, q in NN}$
- Иррациональные числа: $II = RR partial QQ$ (например, $sqrt(2), pi, e$)

== Азы теории множеств

#definition[
  *Множество* — это совокупность определенных и различимых объектов (элементов), мыслимая как единое целое.
]

Пусть $A$ и $B$ — произвольные множества. Основные операции:

1. *Принадлежность:* $x in A$ (элемент $x$ входит в множество $A$).
2. *Включение (подмножество):* $A subset B <=> (forall x in A => x in B)$.
3. *Равенство:* $A = B <=> (A subset B "и" B subset A)$.
4. *Объединение:* $A union B = {x : x in A "или" x in B}$.
5. *Пересечение:* $A sect B = {x : x in A "и" x in B}$.
6. *Разность:* $A diff B = {x : x in A "и" x subset.not B}$.
7. *Дополнение:* Если $A subset U$, то $A^c = U diff A$.
8. *Симметрическая разность:* $A triangle B = (A diff B) union (B diff A)$.
9. *Декартово произведение:* $X times Y = {(x, y) : x in X, y in Y}$.

== Отображения

#definition[
  *Отображением* (или функцией) $f: X -> Y$ называется правило, которое каждому элементу $x in X$ (область определения) сопоставляет ровно один элемент $y in Y$ (область значений).
]

Выделяют три важных типа отображений:

#grid(
  columns: (1fr, 1fr, 1fr),
  gutter: 12pt,
  note("Инъекция", [
    Разным прообразам соответствуют разные образы: 
    $x_1 != x_2 => f(x_1) != f(x_2)$.
  ]),
  note("Сюръекция", [
    Каждый элемент $Y$ имеет хотя бы один прообраз:
    $forall y in Y, exists x in X: f(x) = y$.
  ]),
  note("Биекция", [
    Взаимно-однозначное соответствие (инъекция + сюръекция). 
    Существует обратное отображение $f^(-1)$.
  ])
)

== Аксиомы Пеано. Структура $NN$

Множество натуральных чисел $NN$ строится на понятии «следующего» элемента. Пусть $n'$ — элемент, следующий за $n$.

#axiom_block("Аксиомы Пеано", [
  #ax("P1", [$1 in NN$ (единица — натуральное число)])
  #ax("P2", [$forall n in NN : exists! n' in NN$ (у каждого числа есть единственное следующее)])
  #ax("P3", [$forall n in NN space n' != 1$ (единица не следует ни за каким числом)])
  #ax("P4", [$n' = m' => n = m$ (разные числа имеют разные следующие)])
  #ax("P5", [*(Аксиома индукции)* Пусть $M subset NN$. Если $1 in M$ и $(k in M => k' in M)$, то $M = NN$.])
])

=== Операции в $NN$
Поскольку у нас есть только понятие «следующего элемента» ($n'$), операции вводятся рекурсивно:

1. *Сложение ($+$):*
  - $n + 1 := n'$ (прибавить 1 — значит просто взять следующее число)
  - $n + m' := (n + m)'$ (чтобы прибавить "следующее за $m$", нужно сначала прибавить $m$, а потом взять "следующее" от результата)

  #note("Пример: 2 + 2", [
    $2 + 2 = 2 + 1'$ (по определению числа 2)
    $2 + 1' = (2 + 1)'$ (по второму правилу сложения)
    $(2 + 1)' = (2')' = 3' = 4$
  ])

2. *Умножение ($dot$):*
  - $n dot 1 := n$
  - $n dot m' := n dot m + n$ (умножить на "следующее за $m$" — это $m$ раз сложить $n$ и добавить еще одно $n$)

== Порядок на $NN$

#definition[
  Говорят, что $m < n$, если существует такое $k in NN$, что $m + k = n$. 
  Соответственно, $m <= n$, если $m < n$ или $m = n$.
]

Отношение "$<$" на $NN$ обладает свойствами:
1. *Антирефлексивность:* $n < n$ — ложно.
2. *Транзитивность:* $a < b$ и $b < c => a < c$.
3. *Линейность:* Для любых $m, n in NN$ верно либо $m < n$, либо $n < m$, либо $m = n$.

== Теорема о свойстве полной упорядоченности

#theorem[
  Любое непустое подмножество множества натуральных чисел $M subset NN$ содержит наименьший элемент. 
  То есть существует такой элемент $m_0 in M$, что $forall m in M: m_0 <= m$.
]

#proof[
  Докажем методом "от противного", используя аксиому индукции. 
  Пусть $M$ — непустое подмножество $NN$, в котором *нет* наименьшего элемента. 
  Рассмотрим множество $S = {n in NN : n < m "для всех" m in M}$. 
  
  1. $1 in S$. Если бы $1 in M$, то $1$ был бы наименьшим элементом (так как в $NN$ нет чисел меньше $1$), но мы предположили, что наименьшего в $M$ нет.
  2. Пусть $k in S$. Тогда $k+1$ тоже должно быть в $S$. Если бы $k+1 in M$, то $k+1$ был бы наименьшим элементом $M$ (так как все числа, меньшие $k+1$, уже лежат в $S$ и не принадлежат $M$). Значит, $k+1 in S$.
  3. По аксиоме индукции $S = NN$. 
  
  Но если $S = NN$, то $M$ должно быть пустым (так как в $S$ лежат только те числа, которых нет в $M$). Мы пришли к противоречию с тем, что $M != emptyset$. Значит, в любом непустом $M subset NN$ есть наименьший элемент.
]

== Метод математической индукции

Метод математической индукции (ММИ) базируется на пятой аксиоме Пеано и является мощным инструментом для доказательства утверждений $P(n)$, сформулированных для всех $n in NN$.

#definition[
  Суть метода заключается в проверке двух условий:
  1. *Базис индукции:* Утверждение $P(1)$ истинно.
  2. *Индукционный шаг:* Предположение, что если утверждение верно для некоторого произвольного $k$ ($P(k)$ — истинно), то оно обязательно верно и для следующего за ним числа $k+1$ ($P(k+1)$ — истинно).
]

Если оба пункта выполнены, то согласно аксиоме индукции, утверждение $P(n)$ истинно для всех $n in NN$.

=== Примеры применения

#note("Пример 1: Сумма квадратов", [
  Докажем, что $1^2 + 2^2 + dots + n^2 = (n(n+1)(2n+1))/6$.
  
  1. *Базис:* При $n=1$: $1^2 = (1 dot 2 dot 3)/6 = 1$. (Верно)
  2. *Шаг:* Пусть для $n=k$ верно: $S_k = (k(k+1)(2n+1))/6$.
  Докажем для $n=k+1$:
  $ S_(k+1) = S_k + (k+1)^2 = (k(k+1)(2k+1))/6 + (k+1)^2 $
  Вынесем $(k+1)$ за скобку:
  $ S_(k+1) = (k+1) ( (2k^2 + k)/6 + (k+1) ) = (k+1) ( (2k^2 + 7k + 6)/6 ) $
  Разложим квадратный трехчлен в скобках: $2k^2 + 7k + 6 = (k+2)(2k+3)$.
  Итого: $S_(k+1) = ((k+1)(k+2)(2(k+1)+1))/6$. (Верно)
])

#note("Пример 2: Неравенство Бернулли", [
  Докажем, что для $x > -1$ и $n in NN$: $(1 + x)^n >= 1 + n x$.
  
  1. *Базис:* При $n=1$: $1 + x >= 1 + x$. (Верно)
  2. *Шаг:* Пусть верно для $n=k$: $(1+x)^k >= 1 + k x$.
  Умножим обе части на $(1+x)$ (оно положительно, так как $x > -1$):
  $ (1+x)^(k+1) >= (1 + k x)(1 + x) = 1 + x + k x + k x^2 $
  $ (1+x)^(k+1) >= 1 + (k+1)x + k x^2 $
  Так как $k x^2 >= 0$, то:
  $ 1 + (k+1)x + k x^2 >= 1 + (k+1)x $
  Следовательно, $(1+x)^(k+1) >= 1 + (k+1)x$. (Верно)
])

#pagebreak()
== Мощность множества

#definition[
  Говорят, что множества $A$ и $B$ имеют *одинаковую мощность* (равномощны, $A thick approx B$), если между ними можно установить взаимно-однозначное соответствие (биекцию).
]

Это определение позволяет сравнивать множества, не пересчитывая их элементы (что невозможно для бесконечных множеств).

== Счетные множества

#definition[
  Множество $A$ называется *счетным*, если оно равномощно множеству натуральных чисел $NN$ ($A thick approx NN$). 
]

Иными словами, множество счетно, если его элементы можно занумеровать натуральными числами: $a_1, a_2, a_3, dots$

#note("Свойства счетных множеств", [
  1. Любое подмножество счетного множества либо конечно, либо счетно.
  2. Объединение конечного или счетного числа счетных множеств счетно.
  3. Множество целых чисел $ZZ$ счетно (последовательность: $0, 1, -1, 2, -2, dots$).
])

== Теорема о равномощности $NN$ и $QQ$

Эта теорема контринтуитивна, так как рациональных чисел "плотно" много на прямой, но по мощности их не больше, чем натуральных.

#theorem[
  Множество рациональных чисел $QQ$ счетно.
]

#proof[
  Любое положительное рациональное число можно представить в виде дроби $p/q$, где $p, q in NN$. Расположим их в виде бесконечной таблицы, где номер строки — это $p$, а номер столбца — это $q$:
  
  $ 1/1, 1/2, 1/3, dots $
  $ 2/1, 2/2, 2/3, dots $
  $ 3/1, 3/2, 3/3, dots $
  
  Будем пересчитывать элементы таблицы "диагоналями" (метод зигзага Кантора):
  1. Сначала $1/1$ (сумма $p+q=2$).
  2. Затем $2/1, 1/2$ (сумма $p+q=3$).
  3. Затем $1/3, 2/2, 3/1$ (сумма $p+q=4$) и так далее.
  
  В этом списке будем пропускать дроби, которые уже встречались в сокращенном виде (например, $2/2$ пропускаем, так как $1/1$ уже была). Таким образом, мы выстроим все положительные рациональные числа в один нумерованный список. Аналогично добавляются отрицательные и ноль. Значит, $|QQ| = |NN|$.
]

#pagebreak()
== Булеан и теорема Кантора

#definition[
  *Булеаном* (или множеством всех подмножеств) множества $X$ называется множество, элементами которого являются все возможные подмножества множества $X$. 
  Обозначается: $P(X)$ или $2^X$.
]

Для конечного множества из $n$ элементов мощность булеана равна $2^n$ (отсюда и обозначение). Но что происходит с бесконечными множествами?

#note("Теорема Кантора")[
  Мощность любого множества $X$ строго меньше мощности его булеана:
  $|X| < |P(X)|$
]

#proof[
  Чтобы доказать, что $|X| < |P(X)|$, нужно показать две вещи:
  1. Существует инъекция из $X$ в $P(X)$ (это очевидно: каждому $x in X$ сопоставим синглтон $\{x\} in P(X)$).
  2. Не существует сюръекции из $X$ в $P(X)$.
  
  Докажем второе от противного. Пусть существует отображение $f: X -> P(X)$, которое является сюръекцией. Это значит, что любое подмножество $A subset X$ является образом какого-то элемента $x$.
  
  Рассмотрим специальное подмножество $B subset X$, состоящее из элементов, которые *не содержатся* в своем образе:
  $ B = {x in X : x thin subset.not thin f(x)} $
  
  Так как $f$ — сюръекция, для этого множества $B$ должен найтись прообраз $b in X$, такой что $f(b) = B$. 
  Разберем два возможных случая для элемента $b$:
  1. Если $b in B$, то по определению множества $B$ имеем $b subset.not f(b)$. Но $f(b) = B$, значит $b subset.not B$. Противоречие.
  2. Если $b subset.not B$, то по определению множества $B$ имеем $b in f(b)$. Но $f(b) = B$, значит $b in B$. Противоречие.
  
  В обоих случаях мы пришли к противоречию. Следовательно, сюръекции не существует, и $|X| < |P(X)|$.
]

#pagebreak()

== Упорядоченное поле

#definition[
  Множество $F$ называется *упорядоченным полем*, если на нем заданы две бинарные операции (сложение и умножение) и отношение порядка ($<.eq$), удовлетворяющие следующим группам аксиом:
]

#axiom_block("I. Аксиомы поля (алгебраические)", [
  1. *Сложение:* Коммутативность ($a+b=b+a$), ассоциативность, наличие нуля ($0$) и противоположного элемента ($-a$).
  2. *Умножение:* Коммутативность, ассоциативность, наличие единицы ($1$) и обратного элемента ($a^(-1)$ для $a != 0$).
  3. *Дистрибутивность:* $a(b+c) = a b + a c$.
])

#axiom_block("II. Аксиомы порядка", [
  1. *Линейность:* Для любых $a, b$ верно либо $a <= b$, либо $b <= a$.
  2. *Антисимметричность:* $(a <= b$ и $b <= a) => a = b$.
  3. *Транзитивность:* $(a <= b$ и $b <= c) => a <= c$.
])

#axiom_block("III. Связь операций и порядка", [
  1. $a <= b => a + c <= b + c$ (монотонность сложения).
  2. $(0 <= a $ и $ 0 <= b) => 0 <= a dot b$ (сохранение знака при умножении).
])

== Принцип полноты. Определение множества $RR$

Главное отличие $RR$ от $QQ$ заключается в *аксиоме непрерывности (полноты)*. Существует несколько эквивалентных формулировок, классической считается аксиома непрерывности Кантора или принцип существования верхней грани.

#axiom_block("Аксиома непрерывности (Полноты)", [
  Пусть $A subset RR$ и $B subset RR$ — два непустых множества таких, что для любых $a in A$ и $b in B$ выполняется неравенство $a <= b$. 
  Тогда существует такое число $c in RR$, что для всех $a in A, b in B$:
  $ a <= c <= b $
])

#definition[
  *Множество вещественных чисел* $RR$ — это полное упорядоченное поле, содержащее $QQ$ в качестве подполя.
]

#note("Замечание", [
  Число $c$ из аксиомы полноты разделяет множества $A$ и $B$. В рациональных числах это не всегда так: если взять $A = {q in QQ : q^2 < 2}$ и $B = {q in QQ : q^2 > 2}$, то в $QQ$ не найдется числа $c$, которое бы их разделяло (так как $sqrt(2) subset.not QQ$).
])

== Грани числового множества

Пусть $X subset RR$ — непустое подмножество вещественных чисел.

#definition[
  1. Число $M$ называется *верхней гранью* множества $X$, если $forall x in X: x <= M$. В этом случае множество называется *ограниченным сверху*.
  2. Число $m$ называется *нижней гранью* множества $X$, если $forall x in X: x >= m$. В этом случае множество называется *ограниченным снизу*.
]

Если множество ограничено и сверху, и снизу, оно называется просто *ограниченным*. 

Однако верхних граней может быть бесконечно много (если $M$ — грань, то $M+1$ тоже грань). Нам нужно выбрать самую «точную».

#definition[
  *Точной верхней гранью* (супремумом) множества $X$ называется *наименьшая* из его верхних граней.
  Обозначение: $S = sup X$.
]

#note("Критерий супремума", [
  Число $S$ является $sup X$ тогда и только тогда, когда выполняются два условия:
  1. $forall x in X: x <= S$ (это верхняя грань).
  2. $forall epsilon > 0 : exists x_epsilon in X: x_epsilon > S - epsilon$ (нельзя уменьшить грань даже на чуть-чуть, не потеряв элементы множества).
])

#definition[
  *Точной нижней гранью* (инфимумом) множества $X$ называется *наибольшая* из его нижних граней.
  Обозначение: $s = inf X$.
]

== Теорема о принципе верхней грани

#theorem[
  Любое непустое подмножество вещественных чисел, ограниченное сверху, имеет точную верхнюю грань (супремум). 
  (Аналогично: любое непустое подмножество, ограниченное снизу, имеет точную нижнюю грань).
]

#note("Разница между max и sup", [
  Если у множества есть максимум ($max X$), то $sup X = max X$. 
  Но у множества может не быть максимума, а супремум будет. 
  Пример: для интервала $X = (0, 1)$ число $1$ является $sup X$, но $max X$ не существует, так как само число $1$ не принадлежит интервалу.
])

== Ограниченность множества натуральных чисел

#theorem[
  Множество натуральных чисел $NN$ не ограничено сверху в $RR$.
]

#proof[
  Докажем от противного. Пусть $NN$ ограничено сверху. 
  Тогда по *принципу верхней грани* у него существует точная верхняя грань в $RR$. Пусть $S = sup NN$.
  
  По определению супремума (критерий), для любого $epsilon > 0$ найдется такой элемент множества, который больше $S - epsilon$. 
  Возьмем $epsilon = 1$. Тогда существует такое $n_0 in NN$, что:
  $ n_0 > S - 1 $
  
  Прибавим к обеим частям единицу:
  $ n_0 + 1 > S $
  
  Но по аксиомам Пеано $n_0 + 1$ также является натуральным числом ($n_0 + 1 in NN$). 
  Мы получили, что в $NN$ есть элемент, который больше его точной верхней грани $S$. Это противоречие. 
  Следовательно, $NN$ не ограничено сверху.
]

== Принцип Архимеда

#theorem[
  Для любого вещественного числа $x in RR$ существует такое натуральное число $n in NN$, что $n > x$.
]

#note("Геометрическая интерпретация", [
  Каким бы длинным ни был отрезок $x$ и каким бы коротким ни был единичный шаг, откладывая шаги достаточное количество раз ($n$), мы рано или поздно выйдем за пределы $x$.
])

#proof[
  Эта теорема является прямой переформулировкой предыдущей теоремы об неограниченности $NN$. Если бы такого $n$ не нашлось, то для всех $n in NN$ выполнялось бы $n <= x$, что означало бы ограниченность $NN$ сверху числом $x$. А мы только что доказали, что это невозможно.
]

=== Важное следствие (Бесконечно малые)
Из принципа Архимеда следует, что для любого $epsilon > 0$ существует такое $n in NN$, что:
$ 1/n < epsilon $
Это база для определения пределов, которую мы будем использовать постоянно. Мы всегда сможем найти "достаточно большой" номер $n$, чтобы дробь $1/n$ стала меньше любого наперед заданного крошечного числа.

#pagebreak()
== Лемма о вложенных отрезках

#definition[
  Последовательность отрезков $[a_n, b_n]$ называется *вложенной*, если каждый последующий отрезок содержится в предыдущем:
  $ [a_1, b_1] supset [a_2, b_2] supset dots supset [a_n, b_n] supset dots $
  Это эквивалентно условиям: $a_n <= a_(n+1)$ и $b_(n+1) <= b_n$ для всех $n in NN$.
]

#note("Принцип Кантора")[
  Для любой вложенной последовательности сегментов (отрезков) существует хотя бы одна точка $c$, принадлежащая им всем:
  $ exists c in RR : forall n in NN, c in [a_n, b_n] $
]

#proof[
  Рассмотрим множества левых концов $A = {a_n}$ и правых концов $B = {b_n}$. 
  Так как отрезки вложены, любой левый конец $a_k$ не превосходит любого правого конца $b_m$. 
  Действительно, если $k <= m$, то $a_k <= a_m <= b_m$. Если $k > m$, то $a_k <= b_k <= b_m$.
  Согласно *аксиоме полноты (непрерывности)*, существует число $c$, разделяющее эти множества:
  $ a_n <= c <= b_n space forall n in NN $
  Это и означает, что $c$ принадлежит каждому отрезку $[a_n, b_n]$.
]

#note("Случай стягивающихся отрезков", [
  Если к условию вложенности добавить требование, что длина отрезков стремится к нулю ($b_n - a_n -> 0$ при $n -> infinity$), то точка $c$ будет *единственной*.
])

#pagebreak()
== Конечное покрытие (Принцип Бореля — Лебега)

#definition[
  Система открытых интервалов ${ (alpha_i, beta_i) }$ называется *покрытием* множества $X$, если каждая точка $x in X$ принадлежит хотя бы одному интервалу системы.
]

#note("Лемма Гейне — Бореля")[
  Из любого покрытия отрезка $[a, b]$ системой открытых интервалов можно извлечь *конечное* подпокрытие.
]

#proof[
  Докажем методом "деления пополам". Предположим, что для отрезка $[a, b]$ нельзя выбрать конечное подпокрытие. 
  1. Разделим $[a, b]$ пополам. Хотя бы для одной из половин (обозначим её $I_1$) тоже нельзя выбрать конечное подпокрытие.
  2. Продолжая этот процесс, получим систему вложенных отрезков $I_1 supset I_2 supset dots$, длина которых стремится к нулю, и для каждого из которых конечное подпокрытие невозможно.
  3. По лемме Кантора существует общая точка $c$, принадлежащая всем $I_n$. 
  4. Так как $c in [a, b]$, она покрыта каким-то интервалом $(alpha, beta)$ из исходной системы.
  5. Но при достаточно большом $n$ отрезок $I_n$ полностью попадет внутрь этого интервала $(alpha, beta)$ (так как его длина стремится к 0). 
  Значит, $I_n$ покрывается всего *одним* интервалом. Противоречие.
]

#pagebreak()
== Предельная точка (Принцип Больцано — Вейерштрасса)

#definition[
  Точка $a$ называется *предельной точкой* множества $X$, если в любой её $epsilon$-окрестности содержится бесконечно много точек этого множества.
]

#theorem[
  Любое ограниченное бесконечное подмножество $X subset RR$ имеет хотя бы одну предельную точку.
]

#proof[
  1. Раз множество $X$ ограничено, оно лежит в некотором отрезке $[a, b]$.
  2. Разделим $[a, b]$ пополам. Хотя бы в одной из половин содержится бесконечно много точек множества $X$. Обозначим эту половину $I_1$.
  3. Повторяя процесс, строим систему вложенных отрезков $I_n$, каждый из которых содержит бесконечно много точек $X$.
  4. По лемме Кантора существует точка $c$, принадлежащая всем $I_n$.
  5. Любая окрестность точки $c$ при достаточно большом $n$ будет содержать отрезок $I_n$. А раз в $I_n$ бесконечно много точек $X$, то и в окрестности $c$ их бесконечно много.
  Значит, $c$ — предельная точка.
]

== Теорема Кантора (Диагональный метод)

#theorem[
  Множество вещественных чисел на отрезке $[0, 1]$ несчетно.
]

#proof[
  Докажем от противного. Допустим, что все числа из $[0, 1]$ можно пересчитать (занумеровать): $x_1, x_2, x_3, dots$.
  Запишем каждое число в виде бесконечной десятичной дроби:
  $ x_1 = 0, d_(11) d_(12) d_(13) dots $
  $ x_2 = 0, d_(21) d_(22) d_(23) dots $
  $ x_3 = 0, d_(31) d_(32) d_(33) dots $
  где $d_(i j)$ — $j$-тая цифра $i$-того числа.

  Сконструируем новое число $c = 0, c_1 c_2 c_3 dots$ по следующему правилу:
  - Если $d_(n n) = 1$, то выберем $c_n = 2$.
  - Если $d_(n n) \neq 1$, то выберем $c_n = 1$.

  Теперь сравним число $c$ с каждым числом из нашего списка:
  - $c$ отличается от $x_1$ в первой цифре ($c_1 \neq d_(11)$).
  - $c$ отличается от $x_2$ во второй цифре ($c_2 \neq d_(22)$).
  - \dots
  - $c$ отличается от $x_n$ в $n$-той цифре.

  Значит, числа $c$ нет в нашем списке. Но $c in [0, 1]$. Противоречие. Следовательно, отрезок несчетен.
]

#note("Важное замечание про 0.999...", [
  Чтобы доказательство было строгим, нужно исключить числа с двумя представлениями (типа $0.5000dots = 0.4999dots$). В диагональном методе это решается выбором цифр $c_n$, отличных от $0$ и $9$. Именно поэтому в примере выше мы использовали только $1$ и $2$.
])
#pagebreak()

= Предел последовательности

== Основные определения

#definition[
  *Числовой последовательностью* называется функция $f: NN -> RR$, областью определения которой является множество натуральных чисел. 
  Значение $a_n = f(n)$ называется $n$-ым членом последовательности. Обозначение: $(a_n)$ или $\{a_n\}_{n=1}^infinity$.
]

Теперь самое главное определение в твоей жизни на ближайшие пару лет:

#definition[
  Число $A$ называется *пределом последовательности* $(a_n)$, если для любого наперед заданного положительного числа $epsilon > 0$ найдется такой номер $N$ (зависящий от $epsilon$), что для всех номеров $n > N$ выполняется неравенство:
  $ |a_n - A| < epsilon $
  Записывается как: $lim_(n -> infinity) a_n = A$ или $a_n -> A$. \
  $ forall epsilon > 0 space exists N in NN : space forall n > N => |a_n - A| < epsilon $
]

#note("Геометрический смысл", [
  Вне любой $epsilon$-окрестности точки $A$ лежит лишь *конечное* число членов последовательности, а внутри неё — почти все (все, начиная с некоторого номера).
])

#pagebreak()
== Теорема о единственности предела

#theorem[
  Если последовательность имеет предел, то он единственен.
]

#proof[
  Допустим обратное: последовательность $(a_n)$ имеет два различных предела $A$ и $B$ ($A != B$). 
  Пусть для определенности $B > A$. Возьмем такое $epsilon$, чтобы окрестности этих точек не пересекались. Например, $epsilon = (B-A)/3$.
  
  1. Так как $a_n -> A$, то $exists N_1: forall n > N_1 => a_n in (A-epsilon, A+epsilon)$.
  2. Так как $a_n -> B$, то $exists N_2: forall n > N_2 => a_n in (B-epsilon, B+epsilon)$.
  
  Возьмем $N = max(N_1, N_2)$. Тогда для всех $n > N$ член последовательности $a_n$ должен лежать в обеих окрестностях сразу. 
  Но они не пересекаются! Мы получили противоречие. Значит, $A = B$.
]

== Предел ограниченной последовательности

#theorem[
  Любая сходящаяся последовательность является ограниченной.
]

#proof[
  Пусть $lim_(n -> infinity) a_n = A$. 
  Возьмем $epsilon = 1$. Тогда существует такой номер $N$, что для всех $n > N$ выполняется:
  $ |a_n - A| < 1 => A - 1 < a_n < A + 1 $
  
  Это значит, что все члены последовательности, начиная с $N+1$, ограничены. 
  Осталось конечное число членов: $a_1, a_2, dots, a_N$. 
  Если мы возьмем $M = max(|a_1|, |a_2|, dots, |a_N|, |A-1|, |A+1|)$, то для любого $n$ будет верно:
  $ |a_n| <= M $
  Следовательно, последовательность ограничена.
]

#note("Важно!", [
  Обратное неверно! Ограниченная последовательность не обязательно сходится. Классический пример: $a_n = (-1)^n$. Она зажата между $-1$ и $1$, но предела не имеет, так как "скачет" между ними.
])

== Монотонные последовательности и теорема Вейерштрасса

#definition[
  Последовательность $(a_n)$ называется:
  - *Возрастающей*, если $forall n in NN => a_n <= a_(n+1)$.
  - *Строго возрастающей*, если $forall n in NN => a_n < a_(n+1)$.
  (Аналогично вводятся определения для убывающих последовательностей).
]

#note("Теорема Вейерштрасса")[
  Если последовательность монотонна и ограничена, то она имеет предел. 
  Конкретнее:
  1. Если $(a_n)$ возрастает и ограничена сверху, то $lim_(n arrow.r infinity) a_n = sup {a_n}$.
  2. Если $(a_n)$ убывает и ограничена снизу, то $lim_(n arrow.r infinity) a_n = inf {a_n}$.
]

#proof[
  Пусть $(a_n)$ возрастает и ограничена сверху. 
  Согласно *принципу верхней грани*, у множества её значений существует точная верхняя грань. Пусть $A = sup {a_n}$.
  
  Докажем по определению, что $A$ и есть предел:
  1. $forall n in NN => a_n <= A$ (так как $A$ — верхняя грань).
  2. По критерию супремума, $forall epsilon > 0 space exists N in NN : a_N > A - epsilon$.
  3. Так как последовательность возрастает, то $forall n > N => a_n >= a_N$.
  
  Следовательно, $forall n > N => A - epsilon < a_n <= A < A + epsilon$, что эквивалентно \ $|a_n - A| < epsilon$.
]

#pagebreak()

== Число $e$

Рассмотрим последовательность $x_n = (1 + 1/n)^n$. 

#theorem[
  Последовательность $x_n = (1 + 1/n)^n$ имеет конечный предел.
]

#proof[
*1. Разложение по биному Ньютона.*
Распишем общий член последовательности $x_n$:
$ x_n = (1 + 1/n)^n = sum_(k=0)^n binom(n, k) (1/n)^k $
Распишем несколько первых слагаемых, используя формулу для биномиальных коэффициентов $binom(n, k) = (n(n-1)...(n-k+1))/(k!)$:
$ x_n = 1 + n dot 1/n + (n(n-1))/(2!) dot 1/n^2 + (n(n-1)(n-2))/(3!) dot 1/n^3 + dots + (n(n-1)...(n-n+1))/(n!) dot 1/n^n $
Упростим каждое слагаемое, «занеся» $1/n^k$ внутрь скобок:
$ x_n = 1 + 1 + 1/(2!) (1 - 1/n) + 1/(3!) (1 - 1/n)(1 - 2/n) + dots + 1/(n!) (1 - 1/n)(1 - 2/n)...(1 - (n-1)/n) $

*2. Доказательство монотонности.*
Сравним $x_n$ и $x_(n+1)$. 
- В выражении для $x_(n+1)$ будет на одно слагаемое больше (оно положительное).
- Каждое слагаемое вида $(1 - k/n)$ в $x_(n+1)$ превратится в $(1 - k/(n+1))$.
Так как $1/(n+1) < 1/n$, то $(1 - k/(n+1)) > (1 - k/n)$.
Значит, каждое слагаемое в $x_(n+1)$ больше соответствующего слагаемого в $x_n$. 
*Вывод:* $x_(n+1) > x_n$, последовательность строго возрастает.

*3. Доказательство ограниченности.*
Заметим, что каждая скобка вида $(1 - k/n)$ в разложении меньше единицы. Тогда:
$ x_n < 1 + 1 + 1/(2!) + 1/(3!) + dots + 1/(n!) $
Вспомним, что для $k >= 2$ выполняется неравенство $k! >= 2^(k-1)$. Следовательно, $1/(k!) <= 1/(2^(k-1))$.
Воспользуемся этим для оценки суммы:
$ x_n < 1 + 1 + 1/2 + 1/4 + 1/8 + dots + 1/(2^(n-1)) $
В правой части, начиная со второго слагаемого, мы видим сумму геометрической прогрессии:
$ x_n < 1 + ( 1 - (1/2)^n ) / (1 - 1/2) = 1 + 2 (1 - (1/2)^n ) < 1 + 2 = 3 $
*Вывод:* $x_n$ ограничена сверху числом $3$ (на самом деле она никогда не превышает $2.72$).

*Заключение:*
Так как последовательность $x_n$ монотонно возрастает и ограничена сверху, то по теореме Вейерштрасса она имеет конечный предел. Этот предел и называется числом $e$.
]

#note("Интересный факт", [
  Из этого доказательства сразу видно, что $2 < e <= 3$. База $x_1 = 2$, и так как она растет, $e$ точно больше 2. А из оценки сверху мы получили, что $e$ не больше 3.
])


#definition[
  Предел последовательности $(1 + 1/n)^n$ при $n arrow.r infinity$ называется *числом Эйлера* и обозначается $e$.
  $ e = lim_(n arrow.r infinity) (1 + 1/n)^n approx 2.71828... $
]

== Теорема об отделимости от нуля

#theorem[
  Если $lim_(n arrow.r infinity) a_n = A$ и $A != 0$, то найдутся число $c > 0$ и номер $N$, такие что для всех $n > N$ выполняется:
  $ |a_n| > c $
]

#proof[
  Возьмем $epsilon = (|A|) / 2$. Так как $A != 0$, то $epsilon > 0$.
  По определению предела, $exists N : forall n > N => |a_n - A| < (|A|) / 2$.
  Используя неравенство треугольника $|A| - |a_n| <= |a_n - A|$, получаем:
  $ |A| - |a_n| < (|A|) / 2 quad arrow.r.double quad |a_n| > (|A|) / 2 $
  Положив $c = (|A|) / 2$, получаем требуемое.
]

#pagebreak()

== Арифметические свойства предела

#theorem[
  Пусть последовательности $(a_n)$ и $(b_n)$ сходятся, и 
  $lim_(n arrow.r infinity) a_n = A, quad lim_(n arrow.r infinity) b_n = B$. 
  Тогда:
  1. $lim_(n arrow.r infinity) (a_n plus.minus b_n) = A plus.minus B$
  2. $lim_(n arrow.r infinity) (a_n dot b_n) = A dot B$
  3. $lim_(n arrow.r infinity) (a_n / b_n) = A / B$, при условии $B != 0$ и $b_n != 0$.
]

#proof[
  (Для суммы) 
  Возьмем произвольное $epsilon > 0$. 
  Нам нужно найти такой номер $N$, что $|(a_n + b_n) - (A + B)| < epsilon$.
  Используем неравенство треугольника:
  $ |(a_n + b_n) - (A + B)| = |(a_n - A) + (b_n - B)| <= |a_n - A| + |b_n - B| $
  Так как $a_n arrow.r A$, то для $epsilon/2 exists N_1: forall n > N_1 => |a_n - A| < epsilon/2$.
  Так как $b_n arrow.r B$, то для $epsilon/2 exists N_2: forall n > N_2 => |b_n - B| < epsilon/2$.
  Выбрав $N = max(N_1, N_2)$, получим:
  $ |(a_n + b_n) - (A + B)| < epsilon/2 + epsilon/2 = epsilon $
]

== Переход к пределу в неравенствах

#theorem[
  Пусть $lim a_n = A$ и $lim b_n = B$. 
  Если начиная с некоторого номера $N$ выполняется $a_n <= b_n$, то и $A <= B$.
]

#note("Осторожно!", [
  Если $a_n < b_n$, это *не гарантирует* $A < B$. 
  Пример: $a_n = 0$, $b_n = 1/n$. Всегда $0 < 1/n$, но их пределы равны: $0 = 0$.
])

#note("Теорема об отделимости от границ")[
  Если $a_n <= B$ для всех $n$, то $lim a_n <= B$. 
  Аналогично, если $a_n >= A$, то $lim a_n >= A$.
]
#pagebreak()

== Теорема о сжатой переменной

#note("Теорема о двух милиционерах")[
  Пусть даны три последовательности $(a_n), (b_n), (c_n)$, такие что:
  1. $a_n <= b_n <= c_n$ для всех $n > N_0$.
  2. $lim_(n arrow.r infinity) a_n = lim_(n arrow.r infinity) c_n = A$.
  Тогда последовательность $(b_n)$ также сходится, и $lim_(n arrow.r infinity) b_n = A$.
]

#proof[
  Зафиксируем $epsilon > 0$. 
  Так как $a_n arrow.r A$, то для всех $n > N_1$ имеем $A - epsilon < a_n$.
  Так как $c_n arrow.r A$, то для всех $n > N_2$ имеем $c_n < A + epsilon$.
  Пусть $N = max(N_0, N_1, N_2)$. Тогда для всех $n > N$ выполняется цепочка:
  $ A - epsilon < a_n <= b_n <= c_n < A + epsilon $
  Следовательно, $A - epsilon < b_n < A + epsilon$, что означает $|b_n - A| < epsilon$.
]

== Подпоследовательности

#definition[
  Пусть дана последовательность $(a_n)$. Если мы выберем бесконечную возрастающую последовательность натуральных индексов $n_1 < n_2 < n_3 < dots$, то последовательность $(a_(n_k))$ называется *подпоследовательностью* последовательности $(a_n)$.
]

#theorem[
  Если последовательность $(a_n)$ сходится к $A$, то любая её подпоследовательность также сходится к $A$.
]

#proof[
  Так как $n_k$ — возрастающая последовательность натуральных чисел, то $n_k >= k$. 
  Поскольку $a_n arrow.r A$, то для любого $epsilon > 0$ существует номер $N$, такой что при $n > N$ выполняется $|a_n - A| < epsilon$.
  Тогда для любого $k > N$ индекс $n_k >= k > N$, а значит $|a_(n_k) - A| < epsilon$. 
  Следовательно, $a_(n_k) arrow.r A$.
]
#pagebreak()

== Теорема Больцано — Вейерштрасса

#theorem[
  Из любой ограниченной последовательности можно выделить сходящуюся подпоследовательность.
]

#proof[
  1. Раз последовательность $(a_n)$ ограничена, все её члены лежат в некотором отрезке $[M_1, M_2]$.
  2. Разделим отрезок пополам. В одной из половин содержится бесконечно много членов последовательности. Выберем её и назовем $[a_1, b_1]$.
  3. Повторяем процесс: делим $[a_k, b_k]$ пополам и выбираем ту часть, где бесконечно много членов.
  4. Получаем систему вложенных отрезков, длины которых стремятся к 0. По лемме Кантора существует единственная точка $c$, принадлежащая всем отрезкам.
  5. Выбирая на каждом шаге по одному члену последовательности $a_(n_k)$ из соответствующего отрезка, мы получим подпоследовательность, которая стремится к $c$.
]

== Понятие бесконечных пределов

#definition[
  Говорят, что $lim_(n arrow.r infinity) a_n = +infinity$, если для любого $E > 0$ (сколь угодно большого) найдется номер $N$, такой что для всех $n > N$:
  $ a_n > E $
]

#note("Важно", [
  Если последовательность имеет бесконечный предел, она считается *расходящейся* (в строгом смысле слова "сходимость" зарезервирована для конечных чисел).
])

#pagebreak()

== Теорема о частичных пределах

#theorem[
  Для любой ограниченной последовательности $(a_n)$:
  1. Множество её частичных пределов $E$ непусто.
  2. Множество $E$ ограничено.
  3. Существуют $\max E$ и $\min E$.
]

#proof[
  *1. Непустота.* 
  Так как последовательность $(a_n)$ ограничена, то по теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $(a_(n_k))$. Предел этой подпоследовательности по определению является частичным пределом. Значит, $E != emptyset$.

  *2. Ограниченность.* 
  Так как $(a_n)$ ограничена, то существует такое $M$, что $forall n: |a_n| <= M$. Любой частичный предел $A$ как предел подпоследовательности тоже будет удовлетворять неравенству $|A| <= M$ (по теореме о переходе к пределу в неравенствах). Значит, множество $E$ ограничено.

  *3. Наличие максимума (для $limsup$).*
  Пусть $S = sup E$. Докажем, что $S in E$ (то есть $S$ сам является частичным пределом).
  
  Для этого нам нужно построить подпоследовательность, сходящуюся к $S$:
  - Для $epsilon = 1$ в окрестности $(S-1, S+1)$ лежит хотя бы один частичный предел, а значит, и бесконечно много членов исходной последовательности. Возьмем один из них $a_(n_1)$.
  - Для $epsilon = 1/2$ в окрестности $(S-1/2, S+1/2)$ аналогично выберем $a_(n_2)$ с индексом $n_2 > n_1$.
  - Продолжая для $epsilon = 1/k$, мы получим подпоследовательность $(a_(n_k))$, такую что $|a_(n_k) - S| < 1/k$.
  
  По теореме о зажатой переменной $a_(n_k) arrow.r S$. Значит $S in E$. Следовательно, $sup E = max E$. 
  (Для $inf E = min E$ доказывается аналогично).
]

#note("Важное следствие", [
  Число $A$ является пределом последовательности ($A = lim a_n$) тогда и только тогда, когда:
  $ liminf_{n arrow.r infinity} a_n = limsup_{n arrow.r infinity} a_n = A $
  То есть, когда все "пути", по которым можно идти внутри последовательности, ведут в одну и ту же точку.
])

#pagebreak()

== Сравнение скорости роста последовательностей

Пусть $n arrow.r infinity$. Введем иерархию роста (каждая следующая функция растет "быстрее" предыдущей):

$ ln n quad << quad n^alpha (alpha>0) quad << quad a^n (a>1) quad << quad n! quad << quad n^n $

#note("Что это значит на практике?", [
  Если в дроби в числителе стоит "слабая" функция, а в знаменателе "сильная", то предел равен 0.
  Например:
  1. $lim_(n arrow.r infinity) (ln n) / n^alpha = 0$
  2. $lim_(n arrow.r infinity) n^k / a^n = 0 quad (a > 1)$
  3. $lim_(n arrow.r infinity) a^n / (n!) = 0$
  4. $lim_(n arrow.r infinity) (n!) / n^n = 0$
])

#note("Пример доказательства (экспонента vs факториал)")[
  $lim_(n arrow.r infinity) a^n / (n!) = 0$ для любого $a > 0$.
]
#proof[
  Пусть $x_n = a^n / (n!)$. Рассмотрим отношение соседних членов:
  $ x_(n+1) / x_n = (a^(n+1) / ((n+1)!)) / (a^n / (n!)) = a / (n+1) $
  Начиная с некоторого номера $n > 2a$, это отношение будет меньше $1/2$.
  Значит, $x_n$ убывает и ограничена снизу нулем. По теореме Вейерштрасса предел существует. 
  Пусть $lim x_n = A$. Перейдем к пределу в равенстве $x_(n+1) = x_n dot a/(n+1)$:
  $ A = A dot 0 quad arrow.r.double quad A = 0. $
]
#pagebreak()

== Подпоследовательности

#definition[
  Пусть дана последовательность $(a_n)$. Рассмотрим строго возрастающую последовательность натуральных чисел:
  $ n_1 < n_2 < n_3 < dots < n_k < dots, quad n_k in NN $
  Тогда последовательность $(a_(n_k))$, составленная из членов исходной последовательности с этими индексами, называется *подпоследовательностью* $(a_n)$.
]

#note("Интуиция", [
  Ты просто "вычеркиваешь" некоторые члены из исходного ряда, но оставшиеся берешь в том же порядке, в котором они шли изначально. Главное — их должно остаться бесконечно много.
])

== Теорема о подпоследовательности сходящейся последовательности

#theorem[
  Если последовательность $(a_n)$ сходится к пределу $A$ (конечному или бесконечному), то любая её подпоследовательность $(a_(n_k))$ также сходится к $A$.
]

#proof[
  Рассмотрим случай конечного предела $A$.
  1. Так как $lim_(n arrow.r infinity) a_n = A$, то для любого $epsilon > 0$ существует номер $N$, такой что:
     $ forall n > N => |a_n - A| < epsilon $
  2. Заметим важное свойство индексов: так как $n_k$ — строго возрастающая последовательность натуральных чисел, то $n_k >= k$ для любого $k$.
  3. Тогда, если мы выберем $k > N$, то автоматически $n_k >= k > N$.
  4. Следовательно, для всех $k > N$ выполняется:
     $ |a_(n_k) - A| < epsilon $
  А это по определению означает, что $lim_(k arrow.r infinity) a_(n_k) = A$.
]

#note("Практическое применение", [
  Эту теорему чаще всего используют, чтобы доказать *отсутствие* предела. 
  Если у последовательности есть две подпоследовательности, стремящиеся к *разным* пределам, то сама последовательность предела не имеет. 
  
  *Пример:* $a_n = (-1)^n$. 
  Подпоследовательность $a_(2k) = 1 arrow.r 1$. 
  Подпоследовательность $a_(2k-1) = -1 arrow.r -1$. 
  Пределы разные $=> lim a_n$ не существует.
])

== Теорема Больцано — Вейерштрасса

#theorem[
  Из любой ограниченной последовательности можно выделить сходящуюся подпоследовательность.
]

#proof[
  Пусть $(a_n)$ ограничена, то есть все её члены лежат на некотором отрезке $[a, b]$. 
  Применим метод "деления пополам":
  1. Разделим $[a, b]$ пополам. Хотя бы в одной из половин (обозначим её $I_1$) содержится бесконечное число членов последовательности. Выберем любой $a_(n_1) in I_1$.
  2. Разделим $I_1$ пополам. Снова выберем ту половину ($I_2$), где бесконечно много членов. Выберем $a_(n_2) in I_2$ так, чтобы $n_2 > n_1$.
  3. Продолжая процесс, мы получим систему вложенных отрезков $I_1 supset I_2 supset dots$, длины которых $d_k = (b-a)/2^k arrow.r 0$. 
  4. По лемме Кантора существует единственная точка $c$, общая для всех отрезков. 
  5. Так как $|a_(n_k) - c| <= d_k$, а $d_k arrow.r 0$, то по теореме о зажатой переменной $a_(n_k) arrow.r c$.
  Мы построили сходящуюся подпоследовательность.
]

#pagebreak()

== Понятия бесконечных пределов

Введем определения для случаев, когда последовательность "уходит в бесконечность":

#definition[
  1. $lim_(n arrow.r infinity) a_n = +infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double a_n > E$.
  2. $lim_(n arrow.r infinity) a_n = -infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double a_n < -E$.
  3. $lim_(n arrow.r infinity) a_n = infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double |a_n| > E$.
]

#note("Важно", [
  Если последовательность имеет бесконечный предел, она называется *расходящейся* к бесконечности.
])

== Частичные пределы. Верхний и нижний пределы

#definition[
  Число $A$ (или символ $plus.minus infinity$) называется *частичным пределом* последовательности $(a_n)$, если существует подпоследовательность $(a_(n_k))$, сходящаяся к $A$.
]

#note("О структуре множества частичных пределов")[
  Для любой последовательности множество её частичных пределов (обозначим $E$) непусто (если допускать бесконечные пределы). В этом множестве всегда есть наибольший и наименьший элементы.
]

#definition[
  - *Верхний предел* ($limsup a_n$ или $overline(lim) a_n$) — это наибольший из частичных пределов.
  - *Нижний предел* ($liminf a_n$ или $underline(lim) a_n$) — это наименьший из частичных пределов.
]

#note("Критерий существования предела", [
  Последовательность имеет предел (конечный или бесконечный) тогда и только тогда, когда её верхний и нижний пределы совпадают:
  $ liminf_{n arrow.r infinity} a_n = limsup_{n arrow.r infinity} a_n = lim_{n arrow.r infinity} a_n $
])

== Фундаментальные последовательности

#definition[
  Последовательность $(a_n)$ называется *фундаментальной* (или последовательностью Коши), если для любого $epsilon > 0$ существует такой номер $N$, что для любых индексов $n, m > N$ выполняется неравенство:
  $ |a_n - a_m| < epsilon $
]

#note("В чем фишка?", [
  В определении обычного предела нам нужно знать число $A$. В определении фундаментальности нам нужно знать только сами члены последовательности. Если они "сгущаются" друг к другу на бесконечности, значит, они фундаментальны.
])

== Критерий Коши

#note("Критерий Коши")[
  Для того чтобы последовательность $(a_n)$ имела конечный предел, необходимо и достаточно, чтобы она была фундаментальной.
]

#proof[
  *1. Необходимость ($arrow.r.double$):*
  Пусть $lim a_n = A$. Тогда для $epsilon/2$ существует номер $N$, такой что при $n, m > N$:
  $ |a_n - A| < epsilon/2 quad "и" quad |a_m - A| < epsilon/2 $
  По неравенству треугольника:
  $ |a_n - a_m| = |(a_n - A) - (a_m - A)| <= |a_n - A| + |a_m - A| < epsilon/2 + epsilon/2 = epsilon $
  Следовательно, последовательность фундаментальна.

  *2. Достаточность ($arrow.l.double$):*
  Пусть $(a_n)$ фундаментальна.
  - Сначала докажем, что она *ограничена*. Возьмем $epsilon = 1$, тогда $forall n > N: |a_n - a_(N+1)| < 1$. Все члены после $N$ зажаты в окрестности $a_(N+1)$, значит, вся последовательность ограничена.
  - По теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $a_(n_k) arrow.r A$.
  - Докажем, что и вся последовательность стремится к $A$. 
    $ |a_n - A| <= |a_n - a_(n_k)| + |a_(n_k) - A| $
    Первое слагаемое можно сделать меньше $epsilon/2$ из-за фундаментальности (так как $n$ и $n_k$ велики), второе — из-за сходимости подпоследовательности.
    Значит, $a_n arrow.r A$.
]

== Примеры применения критерия Коши

#note("Расходимость гармонической последовательности")[
  Последовательность частичных сумм $S_n = sum_(k=1)^n 1/k$ расходится.
]

#proof[
  Воспользуемся отрицанием критерия Коши. Нам нужно показать, что:
  $ exists epsilon > 0 : forall N, exists n, m > N => |S_m - S_n| >= epsilon $
  
  Пусть $m = 2n$. Рассмотрим разность:
  $ |S_(2n) - S_n| = 1/(n+1) + 1/(n+2) + dots + 1/(2n) $
  В этой сумме $n$ слагаемых, и каждое из них не меньше самого маленького ($1/(2n)$):
  $ |S_(2n) - S_n| >= n dot 1/(2n) = 1/2 $
  Мы нашли такое $epsilon = 1/2$, что какую бы далекую часть ряда мы ни взяли, мы всегда можем найти кусок, сумма которого больше $1/2$. 
  Значит, последовательность не фундаментальна, а следовательно — расходится.
]

= Предел и непрерывность функций

== Топология вещественной прямой

Пусть $X subset RR$ — некоторое числовое множество.

#definition[
  1. *Внутренняя точка:* Точка $x in X$ называется внутренней, если она входит в $X$ вместе с некоторой своей $epsilon$-окрестностью: $exists epsilon > 0: (x-epsilon, x+epsilon) subset X$.
  2. *Предельная точка:* Точка $a$ (не обязательно из $X$) называется предельной для $X$, если в любой её $epsilon$-окрестности содержится хотя бы одна точка из $X$, отличная от $a$. (Эквивалентно: бесконечно много точек из $X$).
  3. *Изолированная точка:* Точка $x in X$, которая не является предельной.
  4. *Граничная точка:* Точка, в любой окрестности которой есть как точки из $X$, так и точки, не принадлежащие $X$.
]

#definition[
  - Множество называется *открытым*, если все его точки — внутренние.
  - Множество называется *замкнутым*, если оно содержит все свои предельные точки.
]

#note("Примеры", [
  - Интервал $(0, 1)$ — открытое множество.
  - Отрезок $[0, 1]$ — замкнутое множество (содержит свои границы $0$ и $1$).
  - Полуинтервал $[0, 1)$ — ни то, ни другое.
])

#pagebreak()
== Предел функции по Гейне (на языке последовательностей)

Пусть функция $f(x)$ определена в некоторой окрестности точки $a$, за исключением, быть может, самой точки $a$.

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любой последовательности $(x_n)$, такой что:
  1. $x_n arrow.r a$ при $n arrow.r infinity$;
  2. $x_n != a$ (члены последовательности лежат в проколотой окрестности);
  соответствующая последовательность значений функции сходится к $A$:
  $ f(x_n) arrow.r A $
]

Записывается: $lim_(x arrow.r a) f(x) = A$.

== Предел функции по Гейне (на языке последовательностей)

Пусть функция $f(x)$ определена в некоторой окрестности точки $a$, за исключением, быть может, самой точки $a$.

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любой последовательности $(x_n)$, такой что:
  1. $x_n arrow.r a$ при $n arrow.r infinity$;
  2. $x_n != a$ (члены последовательности лежат в проколотой окрестности);
  соответствующая последовательность значений функции сходится к $A$:
  $ f(x_n) arrow.r A $
]

Записывается: $lim_(x arrow.r a) f(x) = A$.

#pagebreak()

== Свойства предела функции

#theorem[
  Если пределы $lim_(x arrow.r a) f(x) = A$ и $lim_(x arrow.r a) g(x) = B$ существуют, то:
  1. *Единственность:* Предел функции в точке единственен.
  2. *Арифметика:* $lim (f plus.minus g) = A plus.minus B$, $lim (f dot g) = A dot B$, $lim (f/g) = A/B$ (при $B != 0$).
  3. *Переход к пределу в неравенствах:* Если $f(x) <= g(x)$ в окрестности $a$, то $A <= B$.
  4. *Теорема о зажатой функции:* Если $f(x) <= h(x) <= g(x)$ и $f, g arrow.r A$, то $h(x) arrow.r A$.
]

== Предел сложной функции

#theorem[
  Пусть $lim_(x arrow.r a) g(x) = b$ и $lim_(y arrow.r b) f(y) = A$. 
  Если в некоторой проколотой окрестности точки $a$ выполняется $g(x) != b$, то:
  $ lim_(x arrow.r a) f(g(x)) = A $
]

== Определение предела по Коши (на языке $epsilon - delta$)

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любого $epsilon > 0$ найдется такое $delta > 0$ (зависящее от $epsilon$), что для всех $x$, удовлетворяющих условию $0 < |x - a| < delta$, выполняется неравенство:
  $ |f(x) - A| < epsilon $
]

#align(center)[
  $ lim_(x arrow.r a) f(x) = A quad <=> quad forall epsilon > 0 space exists delta > 0 : space forall x in dot(U)_delta (a) arrow.r.double f(x) in U_epsilon (A) $
]

#note([Что такое $dot(U)_delta (a)$?], [
  Это *проколотая* дельта-окрестность точки $a$. Условие $0 < |x - a|$ как раз исключает саму точку $a$. Нам не важно, что происходит в самой точке (функция там может быть даже не определена), нам важно, что происходит *рядом*.
])

=== Предел в бесконечности
Если точка $a$ или предел $A$ являются бесконечными, определение слегка меняется:
- $lim_(x arrow.r infinity) f(x) = A$: $forall epsilon > 0 space exists M > 0 : forall x : |x| > M => |f(x) - A| < epsilon$.
- $lim_(x arrow.r a) f(x) = infinity$: $forall E > 0 space exists delta > 0 : forall x : 0 < |x - a| < delta => |f(x)| > E$.

== Теорема о равносильности определений

#theorem[
  Определения предела функции по Гейне и по Коши эквивалентны.
]

#proof[
  *1. Коши $arrow.r.double$ Гейне:*
  Пусть предел по Коши существует. Возьмем любую $x_n arrow.r a$. По определению Коши, для $epsilon$ есть $delta$, в которую рано или поздно попадут все $x_n$ (начиная с номера $N$). Значит, $f(x_n)$ попадет в $epsilon$-окрестность $A$. Сходимость есть.

  *2. Гейне $arrow.r.double$ Коши (от противного):*
  Предположим, что определение Коши не выполняется. Тогда существует такое "плохое" $epsilon$, что для любого $delta_n = 1/n$ найдется точка $x_n$, которая лежит в $delta_n$-окрестности $a$, но $f(x_n)$ лежит вне $epsilon$-окрестности $A$. 
  Мы построили последовательность $x_n arrow.r a$, для которой $f(x_n) arrow.not.r A$. Это противоречит определению Гейне.
]

== Свойства предела функции (локальные)

#note("О локальной ограниченности")[
  Если функция имеет конечный предел в точке $a$, то она ограничена в некоторой проколотой окрестности этой точки.
]

#note("Об отделимости от нуля")[
  Если $lim_(x arrow.r a) f(x) = A$ и $A != 0$, то существует такая окрестность точки $a$, в которой значения функции имеют тот же знак, что и $A$, и отделены от нуля:
  $ exists delta > 0, exists c > 0 : forall x in dot(U)_delta (a) => |f(x)| > c $
]

== Замечательные пределы

#grid(
  columns: (1fr, 1fr),
  gutter: 20pt,
  note("Первый замечательный", [
    $ lim_(x arrow.r 0) (sin x) / x = 1 $
    Раскрывает неопределенность $0/0$ для тригонометрии.
  ]),
  note("Второй замечательный", [
    $ lim_(x arrow.r infinity) (1 + 1/x)^x = e $
    Или в форме $x arrow.r 0$: $lim_(x arrow.r 0) (1 + x)^(1/x) = e$.
  ])
)

== Односторонние пределы

#definition[
  1. *Предел слева:* Число $A$ называется пределом функции $f(x)$ в точке $a$ слева, если для любого $epsilon > 0$ существует $delta > 0$, такое что для всех $x in (a - delta, a)$ выполняется $|f(x) - A| < epsilon$.
     Обозначение: $lim_(x arrow.r a - 0) f(x) = f(a-0) = A$.
  
  2. *Предел справа:* Аналогично, но для $x in (a, a + delta)$.
     Обозначение: $lim_(x arrow.r a + 0) f(x) = f(a+0) = A$.
]

== Критерий существования предела

#theorem[
  Предел функции $f(x)$ в точке $a$ существует тогда и только тогда, когда существуют оба односторонних предела и они равны между собой:
  $ lim_(x arrow.r a) f(x) = A quad <=> quad f(a-0) = f(a+0) = A $
]

#note("Зачем это нужно?", [
  Если пределы слева и справа существуют, но не равны, в этой точке у функции происходит "скачок" (разрыв первого рода).
])

#pagebreak()

== Бесконечно малые и бесконечно большие функции

#definition[
  Функция $alpha(x)$ называется *бесконечно малой* (б.м.) при $x arrow.r a$, если $lim_(x arrow.r a) alpha(x) = 0$.
]

#definition[
  Функция $f(x)$ называется *бесконечно большой* (б.б.) при $x arrow.r a$, если $lim_(x arrow.r a) |f(x)| = +infinity$.
]

=== Свойства бесконечно малых
1. Сумма конечного числа б.м. функций есть б.м. функция.
2. Произведение б.м. функции на ограниченную функцию есть б.м. функция.
3. Произведение двух б.м. функций есть б.м. функция.

=== Лемма о связи б.б. и б.м.
#theorem[
  Если $f(x)$ — бесконечно большая функция при $x arrow.r a$, то $1/f(x)$ — бесконечно малая функция в этой точке (и наоборот, если б.м. функция не обращается в ноль в окрестности $a$).
]

== Представление функции через бесконечно малую

#theorem[
  Число $A$ является пределом функции $f(x)$ в точке $a$ тогда и только тогда, когда функцию можно представить в виде:
  $ f(x) = A + alpha(x) $
  где $alpha(x)$ — бесконечно малая функция при $x arrow.r a$.
]

== Связь бесконечно больших и бесконечно малых функций

#lemma[
  1. Если функция $f(x)$ является бесконечно большой при $x arrow.r a$, то функция $1/f(x)$ является бесконечно малой при $x arrow.r a$.
  2. Если функция $alpha(x)$ является бесконечно малой при $x arrow.r a$ и $alpha(x) != 0$ в некоторой проколотой окрестности точки $a$, то функция $1/alpha(x)$ является бесконечно большой при $x arrow.r a$.
]

#proof[
  Докажем первый пункт. Пусть $f(x)$ — б.б. при $x arrow.r a$. 
  По определению, для любого (сколь угодно большого) числа $E > 0$ существует $delta > 0$, такое что:
  $ forall x in dot(U)_delta (a) arrow.r.double |f(x)| > E $
  Рассмотрим произвольное $epsilon > 0$. Положим $E = 1/epsilon$. Тогда найдется такое $delta$, что:
  $ |f(x)| > 1/epsilon quad <=> quad 1/(|f(x)|) < epsilon $
  Это в точности означает, что $1/f(x)$ — бесконечно малая функция. Второй пункт доказывается аналогично переходом от $epsilon$ к $E = 1/epsilon$.
]

#pagebreak()
== Критерий существования конечного предела в терминах б.м.

#theorem[
  Число $A$ является пределом функции $f(x)$ в точке $a$ тогда и только тогда, когда функцию в окрестности точки $a$ можно представить в виде:
  $ f(x) = A + alpha(x) $
  где $alpha(x)$ — бесконечно малая функция при $x arrow.r a$.
]

#proof[
  *Необходимость ($arrow.r.double$):*
  Пусть $lim_(x arrow.r a) f(x) = A$. Положим $alpha(x) = f(x) - A$. 
  Тогда $lim_(x arrow.r a) alpha(x) = lim_(x arrow.r a) (f(x) - A) = A - A = 0$. 
  Значит, $alpha(x)$ — б.м. по определению, и $f(x) = A + alpha(x)$.

  *Достаточность ($arrow.l.double$):*
  Пусть $f(x) = A + alpha(x)$, где $lim_(x arrow.r a) alpha(x) = 0$. 
  По свойствам пределов (предел константы равен константе, предел суммы равен сумме пределов):
  $ lim_(x arrow.r a) f(x) = lim_(x arrow.r a) (A + alpha(x)) = lim_(x arrow.r a) A + lim_(x arrow.r a) alpha(x) = A + 0 = A $
  Значит, предел функции равен $A$.
]

#note("💡 Почему это важно?", [
  Это представление — первый шаг к понятию *дифференцируемости*. Позже мы увидим, что если приращение функции можно представить как $Delta f = L dot Delta x + alpha(Delta x) dot Delta x$, то функция дифференцируема. Мы заменяем сложную функцию на простую линейную часть плюс "малый мусор".
])