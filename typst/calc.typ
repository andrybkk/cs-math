#import "@preview/cetz:0.3.2"

#set page(
  paper: "a4", 
  margin: (x: 2cm, y: 2.5cm), 
  numbering: "1 / 1"
)

#set text(
  font: "New Computer Modern",
  size: 13pt,
  lang: "ru"
)

#set par(
  justify: true,
  leading: 0.65em
)

#show heading: set text(fill: blue.darken(20%))
#show heading: set text(weight: "bold")

#show heading.where(level: 1): it => [
  #set text(size: 24pt)
  #v(1em)
  #it
  #v(-20pt)
  #line(length: 100%, stroke: 1pt + blue.darken(20%))
]

#show heading.where(level: 2): set text(size: 18pt)

#let note(title, body) = rect(
  fill: blue.lighten(90%),
  stroke: blue.darken(20%) + 1pt,
  radius: 4pt,
  width: 100%,
  inset: 12pt
)[
  *#title* \
  #body
]

#let ax(id, body) = grid(
  columns: (30pt, 1fr),
  gutter: 10pt,
  v(0em) + [*#id*],
  body
)

#let axiom_block(title, content) = block(
  width: 100%,
  stroke: 0.5pt + gray,
  radius: 3pt,
  inset: 12pt,
  fill: rgb("#fafafa")
)[
  #set text(size: 11pt)
  #align(center)[#text(weight: "bold", size: 13pt)[#title]]
  #v(0.4em)
  #content
]

#let definition(body) = note("Определение", body)
#let theorem(body) = note("Теорема", body)
#let lemma(body) = note("Лемма", body)
#let proof(body) = block(spacing: 1.2em, inset: (left: 1em))[
  _Доказательство._ #body #h(1fr) $qed$
]

#let Arg = math.op("Arg")
#let arg = math.op("arg")
#let Re = math.op("Re")
#let Im = math.op("Im")
#let sgn = math.op("sgn")

= Матан

== Вещественные числа

#definition[
  *Множество вещественных (действительных) чисел* $RR$ — это математическая абстракция, представляющая собой совокупность всех возможных значений длин отрезков, их координат на прямой, а также предельных значений рациональных чисел.
]

В курсе анализа вещественные числа вводятся либо аксиоматически (как полное упорядоченное поле), либо конструктивно (через сечения Дедекинда или фундаментальные последовательности Кантора). 

Множество $RR$ включает в себя:
- Натуральные числа: $NN = {1, 2, 3, dots}$
- Целые числа: $ZZ = {dots, -2, -1, 0, 1, 2, dots}$
- Рациональные числа: $QQ = {p/q : p in ZZ, q in NN}$
- Иррациональные числа: $II = RR partial QQ$ (например, $sqrt(2), pi, e$)

== Азы теории множеств

#definition[
  *Множество* — это совокупность определенных и различимых объектов (элементов), мыслимая как единое целое.
]

Пусть $A$ и $B$ — произвольные множества. Основные операции:

1. *Принадлежность:* $x in A$ (элемент $x$ входит в множество $A$).
2. *Включение (подмножество):* $A subset B <=> (forall x in A => x in B)$.
3. *Равенство:* $A = B <=> (A subset B "и" B subset A)$.
4. *Объединение:* $A union B = {x : x in A "или" x in B}$.
5. *Пересечение:* $A inter B = {x : x in A "и" x in B}$.
6. *Разность:* $A partial B = {x : x in A "и" x subset.not B}$.
7. *Дополнение:* Если $A subset U$, то $A^c = U partial A$.
8. *Симметрическая разность:* $A triangle B = (A partial B) union (B partial A)$.
9. *Декартово произведение:* $X times Y = {(x, y) : x in X, y in Y}$.

== Отображения

#definition[
  *Отображением* (или функцией) $f: X -> Y$ называется правило, которое каждому элементу $x in X$ (область определения) сопоставляет ровно один элемент $y in Y$ (область значений).
]

Выделяют три важных типа отображений:

#grid(
  columns: (1fr, 1fr, 1fr),
  gutter: 12pt,
  note("Инъекция", [
    Разным прообразам соответствуют разные образы: 
    $x_1 != x_2 => f(x_1) != f(x_2)$.
  ]),
  note("Сюръекция", [
    Каждый элемент $Y$ имеет хотя бы один прообраз:
    $forall y in Y, exists x in X: f(x) = y$.
  ]),
  note("Биекция", [
    Взаимно-однозначное соответствие (инъекция + сюръекция). 
    Существует обратное отображение $f^(-1)$.
  ])
)

== Аксиомы Пеано. Структура $NN$

Множество натуральных чисел $NN$ строится на понятии «следующего» элемента. Пусть $n'$ — элемент, следующий за $n$.

#axiom_block("Аксиомы Пеано", [
  #ax("P1", [$1 in NN$ (единица — натуральное число)])
  #ax("P2", [$forall n in NN : exists! n' in NN$ (у каждого числа есть единственное следующее)])
  #ax("P3", [$forall n in NN space n' != 1$ (единица не следует ни за каким числом)])
  #ax("P4", [$n' = m' => n = m$ (разные числа имеют разные следующие)])
  #ax("P5", [*(Аксиома индукции)* Пусть $M subset NN$. Если $1 in M$ и $(k in M => k' in M)$, то $M = NN$.])
])

=== Операции в $NN$
Поскольку у нас есть только понятие «следующего элемента» ($n'$), операции вводятся рекурсивно:

1. *Сложение ($+$):*
  - $n + 1 := n'$ (прибавить 1 — значит просто взять следующее число)
  - $n + m' := (n + m)'$ (чтобы прибавить "следующее за $m$", нужно сначала прибавить $m$, а потом взять "следующее" от результата)

  #note("Пример: 2 + 2", [
    $2 + 2 = 2 + 1'$ (по определению числа 2)
    $2 + 1' = (2 + 1)'$ (по второму правилу сложения)
    $(2 + 1)' = (2')' = 3' = 4$
  ])

2. *Умножение ($dot$):*
  - $n dot 1 := n$
  - $n dot m' := n dot m + n$ (умножить на "следующее за $m$" — это $m$ раз сложить $n$ и добавить еще одно $n$)

== Порядок на $NN$

#definition[
  Говорят, что $m < n$, если существует такое $k in NN$, что $m + k = n$. 
  Соответственно, $m <= n$, если $m < n$ или $m = n$.
]

Отношение "$<$" на $NN$ обладает свойствами:
1. *Антирефлексивность:* $n < n$ — ложно.
2. *Транзитивность:* $a < b$ и $b < c => a < c$.
3. *Линейность:* Для любых $m, n in NN$ верно либо $m < n$, либо $n < m$, либо $m = n$.

== Теорема о свойстве полной упорядоченности

#theorem[
  Любое непустое подмножество множества натуральных чисел $M subset NN$ содержит наименьший элемент. 
  То есть существует такой элемент $m_0 in M$, что $forall m in M: m_0 <= m$.
]

#proof[
  Докажем методом "от противного", используя аксиому индукции. 
  Пусть $M$ — непустое подмножество $NN$, в котором *нет* наименьшего элемента. 
  Рассмотрим множество $S = {n in NN : n < m "для всех" m in M}$. 
  
  1. $1 in S$. Если бы $1 in M$, то $1$ был бы наименьшим элементом (так как в $NN$ нет чисел меньше $1$), но мы предположили, что наименьшего в $M$ нет.
  2. Пусть $k in S$. Тогда $k+1$ тоже должно быть в $S$. Если бы $k+1 in M$, то $k+1$ был бы наименьшим элементом $M$ (так как все числа, меньшие $k+1$, уже лежат в $S$ и не принадлежат $M$). Значит, $k+1 in S$.
  3. По аксиоме индукции $S = NN$. 
  
  Но если $S = NN$, то $M$ должно быть пустым (так как в $S$ лежат только те числа, которых нет в $M$). Мы пришли к противоречию с тем, что $M != emptyset$. Значит, в любом непустом $M subset NN$ есть наименьший элемент.
]

== Метод математической индукции

Метод математической индукции (ММИ) базируется на пятой аксиоме Пеано и является мощным инструментом для доказательства утверждений $P(n)$, сформулированных для всех $n in NN$.

#definition[
  Суть метода заключается в проверке двух условий:
  1. *Базис индукции:* Утверждение $P(1)$ истинно.
  2. *Индукционный шаг:* Предположение, что если утверждение верно для некоторого произвольного $k$ ($P(k)$ — истинно), то оно обязательно верно и для следующего за ним числа $k+1$ ($P(k+1)$ — истинно).
]

Если оба пункта выполнены, то согласно аксиоме индукции, утверждение $P(n)$ истинно для всех $n in NN$.

=== Примеры применения

#note("Пример 1: Сумма квадратов", [
  Докажем, что $1^2 + 2^2 + dots + n^2 = (n(n+1)(2n+1))/6$.
  
  1. *Базис:* При $n=1$: $1^2 = (1 dot 2 dot 3)/6 = 1$. (Верно)
  2. *Шаг:* Пусть для $n=k$ верно: $S_k = (k(k+1)(2n+1))/6$.
  Докажем для $n=k+1$:
  $ S_(k+1) = S_k + (k+1)^2 = (k(k+1)(2k+1))/6 + (k+1)^2 $
  Вынесем $(k+1)$ за скобку:
  $ S_(k+1) = (k+1) ( (2k^2 + k)/6 + (k+1) ) = (k+1) ( (2k^2 + 7k + 6)/6 ) $
  Разложим квадратный трехчлен в скобках: $2k^2 + 7k + 6 = (k+2)(2k+3)$.
  Итого: $S_(k+1) = ((k+1)(k+2)(2(k+1)+1))/6$. (Верно)
])

#note("Пример 2: Неравенство Бернулли", [
  Докажем, что для $x > -1$ и $n in NN$: $(1 + x)^n >= 1 + n x$.
  
  1. *Базис:* При $n=1$: $1 + x >= 1 + x$. (Верно)
  2. *Шаг:* Пусть верно для $n=k$: $(1+x)^k >= 1 + k x$.
  Умножим обе части на $(1+x)$ (оно положительно, так как $x > -1$):
  $ (1+x)^(k+1) >= (1 + k x)(1 + x) = 1 + x + k x + k x^2 $
  $ (1+x)^(k+1) >= 1 + (k+1)x + k x^2 $
  Так как $k x^2 >= 0$, то:
  $ 1 + (k+1)x + k x^2 >= 1 + (k+1)x $
  Следовательно, $(1+x)^(k+1) >= 1 + (k+1)x$. (Верно)
])

#pagebreak()
== Мощность множества

#definition[
  Говорят, что множества $A$ и $B$ имеют *одинаковую мощность* (равномощны, $A thick approx B$), если между ними можно установить взаимно-однозначное соответствие (биекцию).
]

Это определение позволяет сравнивать множества, не пересчитывая их элементы (что невозможно для бесконечных множеств).

== Счетные множества

#definition[
  Множество $A$ называется *счетным*, если оно равномощно множеству натуральных чисел $NN$ ($A thick approx NN$). 
]

Иными словами, множество счетно, если его элементы можно занумеровать натуральными числами: $a_1, a_2, a_3, dots$

#note("Свойства счетных множеств", [
  1. Любое подмножество счетного множества либо конечно, либо счетно.
  2. Объединение конечного или счетного числа счетных множеств счетно.
  3. Множество целых чисел $ZZ$ счетно (последовательность: $0, 1, -1, 2, -2, dots$).
])

== Теорема о равномощности $NN$ и $QQ$

Эта теорема контринтуитивна, так как рациональных чисел "плотно" много на прямой, но по мощности их не больше, чем натуральных.

#theorem[
  Множество рациональных чисел $QQ$ счетно.
]

#proof[
  Любое положительное рациональное число можно представить в виде дроби $p/q$, где $p, q in NN$. Расположим их в виде бесконечной таблицы, где номер строки — это $p$, а номер столбца — это $q$:
  
  $ 1/1, 1/2, 1/3, dots $
  $ 2/1, 2/2, 2/3, dots $
  $ 3/1, 3/2, 3/3, dots $
  
  Будем пересчитывать элементы таблицы "диагоналями" (метод зигзага Кантора):
  1. Сначала $1/1$ (сумма $p+q=2$).
  2. Затем $2/1, 1/2$ (сумма $p+q=3$).
  3. Затем $1/3, 2/2, 3/1$ (сумма $p+q=4$) и так далее.
  
  В этом списке будем пропускать дроби, которые уже встречались в сокращенном виде (например, $2/2$ пропускаем, так как $1/1$ уже была). Таким образом, мы выстроим все положительные рациональные числа в один нумерованный список. Аналогично добавляются отрицательные и ноль. Значит, $|QQ| = |NN|$.
]

#pagebreak()
== Булеан и теорема Кантора

#definition[
  *Булеаном* (или множеством всех подмножеств) множества $X$ называется множество, элементами которого являются все возможные подмножества множества $X$. 
  Обозначается: $P(X)$ или $2^X$.
]

Для конечного множества из $n$ элементов мощность булеана равна $2^n$ (отсюда и обозначение). Но что происходит с бесконечными множествами?

#note("Теорема Кантора")[
  Мощность любого множества $X$ строго меньше мощности его булеана:
  $|X| < |P(X)|$
]

Полезное видео - 
  #link("https://youtu.be/LQBByiuEIek?si=rHjVRIgIXA0YOKBJ")[
    #text(fill: blue,  "Теорема Кантора, с доказательством Савватеева")
  ] 

#proof[
  
  
  Чтобы доказать, что $|X| < |P(X)|$, нужно показать две вещи:
  1. Существует инъекция из $X$ в $P(X)$ (это очевидно: каждому $x in X$ сопоставим синглтон $\{x\} in P(X)$).
  2. Не существует сюръекции из $X$ в $P(X)$.
  
  Докажем второе от противного. Пусть существует отображение $f: X -> P(X)$, которое является сюръекцией. Это значит, что любое подмножество $A subset X$ является образом какого-то элемента $x$.
  
  Рассмотрим специальное подмножество $B subset X$, состоящее из элементов, которые *не содержатся* в своем образе:
  $ B = {x in X : x thin subset.not thin f(x)} $
  
  Так как $f$ — сюръекция, для этого множества $B$ должен найтись прообраз $b in X$, такой что $f(b) = B$. 
  Разберем два возможных случая для элемента $b$:
  1. Если $b in B$, то по определению множества $B$ имеем $b subset.not f(b)$. Но $f(b) = B$, значит $b subset.not B$. Противоречие.
  2. Если $b subset.not B$, то по определению множества $B$ имеем $b in f(b)$. Но $f(b) = B$, значит $b in B$. Противоречие.
  
  В обоих случаях мы пришли к противоречию. Следовательно, сюръекции не существует, и $|X| < |P(X)|$.
]

#pagebreak()

== Упорядоченное поле

#definition[
  Множество $F$ называется *упорядоченным полем*, если на нем заданы две бинарные операции (сложение и умножение) и отношение порядка ($<.eq$), удовлетворяющие следующим группам аксиом:
]

#axiom_block("I. Аксиомы поля (алгебраические)", [
  1. *Сложение:* Коммутативность ($a+b=b+a$), ассоциативность, наличие нуля ($0$) и противоположного элемента ($-a$).
  2. *Умножение:* Коммутативность, ассоциативность, наличие единицы ($1$) и обратного элемента ($a^(-1)$ для $a != 0$).
  3. *Дистрибутивность:* $a(b+c) = a b + a c$.
])

#axiom_block("II. Аксиомы порядка", [
  1. *Линейность:* Для любых $a, b$ верно либо $a <= b$, либо $b <= a$.
  2. *Антисимметричность:* $(a <= b$ и $b <= a) => a = b$.
  3. *Транзитивность:* $(a <= b$ и $b <= c) => a <= c$.
])

#axiom_block("III. Связь операций и порядка", [
  1. $a <= b => a + c <= b + c$ (монотонность сложения).
  2. $(0 <= a $ и $ 0 <= b) => 0 <= a dot b$ (сохранение знака при умножении).
])

== Принцип полноты. Определение множества $RR$

Главное отличие $RR$ от $QQ$ заключается в *аксиоме непрерывности (полноты)*. Существует несколько эквивалентных формулировок, классической считается аксиома непрерывности Кантора или принцип существования верхней грани.

#axiom_block("Аксиома непрерывности (Полноты)", [
  Пусть $A subset RR$ и $B subset RR$ — два непустых множества таких, что для любых $a in A$ и $b in B$ выполняется неравенство $a <= b$. 
  Тогда существует такое число $c in RR$, что для всех $a in A, b in B$:
  $ a <= c <= b $
])

#definition[
  *Множество вещественных чисел* $RR$ — это полное упорядоченное поле, содержащее $QQ$ в качестве подполя.
]

#note("Замечание", [
  Число $c$ из аксиомы полноты разделяет множества $A$ и $B$. В рациональных числах это не всегда так: если взять $A = {q in QQ : q^2 < 2}$ и $B = {q in QQ : q^2 > 2}$, то в $QQ$ не найдется числа $c$, которое бы их разделяло (так как $sqrt(2) subset.not QQ$).
])

== Грани числового множества

Пусть $X subset RR$ — непустое подмножество вещественных чисел.

#definition[
  1. Число $M$ называется *верхней гранью* множества $X$, если $forall x in X: x <= M$. В этом случае множество называется *ограниченным сверху*.
  2. Число $m$ называется *нижней гранью* множества $X$, если $forall x in X: x >= m$. В этом случае множество называется *ограниченным снизу*.
]

Если множество ограничено и сверху, и снизу, оно называется просто *ограниченным*. 

Однако верхних граней может быть бесконечно много (если $M$ — грань, то $M+1$ тоже грань). Нам нужно выбрать самую «точную».

#definition[
  *Точной верхней гранью* (супремумом) множества $X$ называется *наименьшая* из его верхних граней.
  Обозначение: $S = sup X$.
]

#note("Критерий супремума", [
  Число $S$ является $sup X$ тогда и только тогда, когда выполняются два условия:
  1. $forall x in X: x <= S$ (это верхняя грань).
  2. $forall epsilon > 0 : exists x_epsilon in X: x_epsilon > S - epsilon$ (нельзя уменьшить грань даже на чуть-чуть, не потеряв элементы множества).
])

#definition[
  *Точной нижней гранью* (инфимумом) множества $X$ называется *наибольшая* из его нижних граней.
  Обозначение: $s = inf X$.
]

== Теорема о принципе верхней грани

#theorem[
  Любое непустое подмножество вещественных чисел, ограниченное сверху, имеет точную верхнюю грань (супремум). 
  (Аналогично: любое непустое подмножество, ограниченное снизу, имеет точную нижнюю грань).
]

#note("Разница между max и sup", [
  Если у множества есть максимум ($max X$), то $sup X = max X$. 
  Но у множества может не быть максимума, а супремум будет. 
  Пример: для интервала $X = (0, 1)$ число $1$ является $sup X$, но $max X$ не существует, так как само число $1$ не принадлежит интервалу.
])

== Ограниченность множества натуральных чисел

#theorem[
  Множество натуральных чисел $NN$ не ограничено сверху в $RR$.
]

#proof[
  Докажем от противного. Пусть $NN$ ограничено сверху. 
  Тогда по *принципу верхней грани* у него существует точная верхняя грань в $RR$. Пусть $S = sup NN$.
  
  По определению супремума (критерий), для любого $epsilon > 0$ найдется такой элемент множества, который больше $S - epsilon$. 
  Возьмем $epsilon = 1$. Тогда существует такое $n_0 in NN$, что:
  $ n_0 > S - 1 $
  
  Прибавим к обеим частям единицу:
  $ n_0 + 1 > S $
  
  Но по аксиомам Пеано $n_0 + 1$ также является натуральным числом ($n_0 + 1 in NN$). 
  Мы получили, что в $NN$ есть элемент, который больше его точной верхней грани $S$. Это противоречие. 
  Следовательно, $NN$ не ограничено сверху.
]

== Принцип Архимеда

#theorem[
  Для любого вещественного числа $x in RR$ существует такое натуральное число $n in NN$, что $n > x$.
]

#note("Геометрическая интерпретация", [
  Каким бы длинным ни был отрезок $x$ и каким бы коротким ни был единичный шаг, откладывая шаги достаточное количество раз ($n$), мы рано или поздно выйдем за пределы $x$.
])

#proof[
  Эта теорема является прямой переформулировкой предыдущей теоремы об неограниченности $NN$. Если бы такого $n$ не нашлось, то для всех $n in NN$ выполнялось бы $n <= x$, что означало бы ограниченность $NN$ сверху числом $x$. А мы только что доказали, что это невозможно.
]

=== Важное следствие (Бесконечно малые)
Из принципа Архимеда следует, что для любого $epsilon > 0$ существует такое $n in NN$, что:
$ 1/n < epsilon $
Это база для определения пределов, которую мы будем использовать постоянно. Мы всегда сможем найти "достаточно большой" номер $n$, чтобы дробь $1/n$ стала меньше любого наперед заданного крошечного числа.

#pagebreak()
== Лемма о вложенных отрезках

#definition[
  Последовательность отрезков $[a_n, b_n]$ называется *вложенной*, если каждый последующий отрезок содержится в предыдущем:
  $ [a_1, b_1] supset [a_2, b_2] supset dots supset [a_n, b_n] supset dots $
  Это эквивалентно условиям: $a_n <= a_(n+1)$ и $b_(n+1) <= b_n$ для всех $n in NN$.
]

#note("Принцип Кантора")[
  Для любой вложенной последовательности сегментов (отрезков) существует хотя бы одна точка $c$, принадлежащая им всем:
  $ exists c in RR : forall n in NN, c in [a_n, b_n] $
]

#proof[
  Рассмотрим множества левых концов $A = {a_n}$ и правых концов $B = {b_n}$. 
  Так как отрезки вложены, любой левый конец $a_k$ не превосходит любого правого конца $b_m$. 
  Действительно, если $k <= m$, то $a_k <= a_m <= b_m$. Если $k > m$, то $a_k <= b_k <= b_m$.
  Согласно *аксиоме полноты (непрерывности)*, существует число $c$, разделяющее эти множества:
  $ a_n <= c <= b_n space forall n in NN $
  Это и означает, что $c$ принадлежит каждому отрезку $[a_n, b_n]$.
]

#note("Случай стягивающихся отрезков", [
  Если к условию вложенности добавить требование, что длина отрезков стремится к нулю ($b_n - a_n -> 0$ при $n -> infinity$), то точка $c$ будет *единственной*.
])

#pagebreak()
== Конечное покрытие (Принцип Бореля — Лебега)

#definition[
  Система открытых интервалов ${ (alpha_i, beta_i) }$ называется *покрытием* множества $X$, если каждая точка $x in X$ принадлежит хотя бы одному интервалу системы.
]

#note("Лемма Гейне — Бореля")[
  Из любого покрытия отрезка $[a, b]$ системой открытых интервалов можно извлечь *конечное* подпокрытие.
]

#proof[
  Докажем методом "деления пополам". Предположим, что для отрезка $[a, b]$ нельзя выбрать конечное подпокрытие. 
  1. Разделим $[a, b]$ пополам. Хотя бы для одной из половин (обозначим её $I_1$) тоже нельзя выбрать конечное подпокрытие.
  2. Продолжая этот процесс, получим систему вложенных отрезков $I_1 supset I_2 supset dots$, длина которых стремится к нулю, и для каждого из которых конечное подпокрытие невозможно.
  3. По лемме Кантора существует общая точка $c$, принадлежащая всем $I_n$. 
  4. Так как $c in [a, b]$, она покрыта каким-то интервалом $(alpha, beta)$ из исходной системы.
  5. Но при достаточно большом $n$ отрезок $I_n$ полностью попадет внутрь этого интервала $(alpha, beta)$ (так как его длина стремится к 0). 
  Значит, $I_n$ покрывается всего *одним* интервалом. Противоречие.
]

#pagebreak()
== Предельная точка (Принцип Больцано — Вейерштрасса)

#definition[
  Точка $a$ называется *предельной точкой* множества $X$, если в любой её $epsilon$-окрестности содержится бесконечно много точек этого множества.
]

#theorem[
  Любое ограниченное бесконечное подмножество $X subset RR$ имеет хотя бы одну предельную точку.
]

#proof[
  1. Раз множество $X$ ограничено, оно лежит в некотором отрезке $[a, b]$.
  2. Разделим $[a, b]$ пополам. Хотя бы в одной из половин содержится бесконечно много точек множества $X$. Обозначим эту половину $I_1$.
  3. Повторяя процесс, строим систему вложенных отрезков $I_n$, каждый из которых содержит бесконечно много точек $X$.
  4. По лемме Кантора существует точка $c$, принадлежащая всем $I_n$.
  5. Любая окрестность точки $c$ при достаточно большом $n$ будет содержать отрезок $I_n$. А раз в $I_n$ бесконечно много точек $X$, то и в окрестности $c$ их бесконечно много.
  Значит, $c$ — предельная точка.
]

== Теорема Кантора (Диагональный метод)

#theorem[
  Множество вещественных чисел на отрезке $[0, 1]$ несчетно.
]

#proof[
  Докажем от противного. Допустим, что все числа из $[0, 1]$ можно пересчитать (занумеровать): $x_1, x_2, x_3, dots$.
  Запишем каждое число в виде бесконечной десятичной дроби:
  $ x_1 = 0, d_(11) d_(12) d_(13) dots $
  $ x_2 = 0, d_(21) d_(22) d_(23) dots $
  $ x_3 = 0, d_(31) d_(32) d_(33) dots $
  где $d_(i j)$ — $j$-тая цифра $i$-того числа.

  Сконструируем новое число $c = 0, c_1 c_2 c_3 dots$ по следующему правилу:
  - Если $d_(n n) = 1$, то выберем $c_n = 2$.
  - Если $d_(n n) \neq 1$, то выберем $c_n = 1$.

  Теперь сравним число $c$ с каждым числом из нашего списка:
  - $c$ отличается от $x_1$ в первой цифре ($c_1 \neq d_(11)$).
  - $c$ отличается от $x_2$ во второй цифре ($c_2 \neq d_(22)$).
  - \dots
  - $c$ отличается от $x_n$ в $n$-той цифре.

  Значит, числа $c$ нет в нашем списке. Но $c in [0, 1]$. Противоречие. Следовательно, отрезок несчетен.
]

#note("Важное замечание про 0.999...", [
  Чтобы доказательство было строгим, нужно исключить числа с двумя представлениями (типа $0.5000dots = 0.4999dots$). В диагональном методе это решается выбором цифр $c_n$, отличных от $0$ и $9$. Именно поэтому в примере выше мы использовали только $1$ и $2$.
])
#pagebreak()

= Предел последовательности

== Основные определения

#definition[
  *Числовой последовательностью* называется функция $f: NN -> RR$, областью определения которой является множество натуральных чисел. 
  Значение $a_n = f(n)$ называется $n$-ым членом последовательности. Обозначение: $(a_n)$ или $\{a_n\}_{n=1}^infinity$.
]

Теперь самое главное определение в твоей жизни на ближайшие пару лет:

#definition[
  Число $A$ называется *пределом последовательности* $(a_n)$, если для любого наперед заданного положительного числа $epsilon > 0$ найдется такой номер $N$ (зависящий от $epsilon$), что для всех номеров $n > N$ выполняется неравенство:
  $ |a_n - A| < epsilon $
  Записывается как: $lim_(n -> infinity) a_n = A$ или $a_n -> A$. \
  $ forall epsilon > 0 space exists N in NN : space forall n > N => |a_n - A| < epsilon $
]

#note("Геометрический смысл", [
  Вне любой $epsilon$-окрестности точки $A$ лежит лишь *конечное* число членов последовательности, а внутри неё — почти все (все, начиная с некоторого номера).
])

#pagebreak()
== Теорема о единственности предела

#theorem[
  Если последовательность имеет предел, то он единственен.
]

#proof[
  Допустим обратное: последовательность $(a_n)$ имеет два различных предела $A$ и $B$ ($A != B$). 
  Пусть для определенности $B > A$. Возьмем такое $epsilon$, чтобы окрестности этих точек не пересекались. Например, $epsilon = (B-A)/3$.
  
  1. Так как $a_n -> A$, то $exists N_1: forall n > N_1 => a_n in (A-epsilon, A+epsilon)$.
  2. Так как $a_n -> B$, то $exists N_2: forall n > N_2 => a_n in (B-epsilon, B+epsilon)$.
  
  Возьмем $N = max(N_1, N_2)$. Тогда для всех $n > N$ член последовательности $a_n$ должен лежать в обеих окрестностях сразу. 
  Но они не пересекаются! Мы получили противоречие. Значит, $A = B$.
]

== Предел ограниченной последовательности

#theorem[
  Любая сходящаяся последовательность является ограниченной.
]

#proof[
  Пусть $lim_(n -> infinity) a_n = A$. 
  Возьмем $epsilon = 1$. Тогда существует такой номер $N$, что для всех $n > N$ выполняется:
  $ |a_n - A| < 1 => A - 1 < a_n < A + 1 $
  
  Это значит, что все члены последовательности, начиная с $N+1$, ограничены. 
  Осталось конечное число членов: $a_1, a_2, dots, a_N$. 
  Если мы возьмем $M = max(|a_1|, |a_2|, dots, |a_N|, |A-1|, |A+1|)$, то для любого $n$ будет верно:
  $ |a_n| <= M $
  Следовательно, последовательность ограничена.
]

#note("Важно!", [
  Обратное неверно! Ограниченная последовательность не обязательно сходится. Классический пример: $a_n = (-1)^n$. Она зажата между $-1$ и $1$, но предела не имеет, так как "скачет" между ними.
])

== Монотонные последовательности и теорема Вейерштрасса

#definition[
  Последовательность $(a_n)$ называется:
  - *Возрастающей*, если $forall n in NN => a_n <= a_(n+1)$.
  - *Строго возрастающей*, если $forall n in NN => a_n < a_(n+1)$.
  (Аналогично вводятся определения для убывающих последовательностей).
]

#note("Теорема Вейерштрасса")[
  Если последовательность монотонна и ограничена, то она имеет предел. 
  Конкретнее:
  1. Если $(a_n)$ возрастает и ограничена сверху, то $lim_(n arrow.r infinity) a_n = sup {a_n}$.
  2. Если $(a_n)$ убывает и ограничена снизу, то $lim_(n arrow.r infinity) a_n = inf {a_n}$.
]

#proof[
  Пусть $(a_n)$ возрастает и ограничена сверху. 
  Согласно *принципу верхней грани*, у множества её значений существует точная верхняя грань. Пусть $A = sup {a_n}$.
  
  Докажем по определению, что $A$ и есть предел:
  1. $forall n in NN => a_n <= A$ (так как $A$ — верхняя грань).
  2. По критерию супремума, $forall epsilon > 0 space exists N in NN : a_N > A - epsilon$.
  3. Так как последовательность возрастает, то $forall n > N => a_n >= a_N$.
  
  Следовательно, $forall n > N => A - epsilon < a_n <= A < A + epsilon$, что эквивалентно \ $|a_n - A| < epsilon$.
]

#pagebreak()

== Число $e$

Рассмотрим последовательность $x_n = (1 + 1/n)^n$. 

#theorem[
  Последовательность $x_n = (1 + 1/n)^n$ имеет конечный предел.
]

#proof[
*1. Разложение по биному Ньютона.*
Распишем общий член последовательности $x_n$:
$ x_n = (1 + 1/n)^n = sum_(k=0)^n binom(n, k) (1/n)^k $
Распишем несколько первых слагаемых, используя формулу для биномиальных коэффициентов $binom(n, k) = (n(n-1)...(n-k+1))/(k!)$:
$ x_n = 1 + n dot 1/n + (n(n-1))/(2!) dot 1/n^2 + (n(n-1)(n-2))/(3!) dot 1/n^3 + dots + (n(n-1)...(n-n+1))/(n!) dot 1/n^n $
Упростим каждое слагаемое, «занеся» $1/n^k$ внутрь скобок:
$ x_n = 1 + 1 + 1/(2!) (1 - 1/n) + 1/(3!) (1 - 1/n)(1 - 2/n) + dots + 1/(n!) (1 - 1/n)(1 - 2/n)...(1 - (n-1)/n) $

*2. Доказательство монотонности.*
Сравним $x_n$ и $x_(n+1)$. 
- В выражении для $x_(n+1)$ будет на одно слагаемое больше (оно положительное).
- Каждое слагаемое вида $(1 - k/n)$ в $x_(n+1)$ превратится в $(1 - k/(n+1))$.
Так как $1/(n+1) < 1/n$, то $(1 - k/(n+1)) > (1 - k/n)$.
Значит, каждое слагаемое в $x_(n+1)$ больше соответствующего слагаемого в $x_n$. 
*Вывод:* $x_(n+1) > x_n$, последовательность строго возрастает.

*3. Доказательство ограниченности.*
Заметим, что каждая скобка вида $(1 - k/n)$ в разложении меньше единицы. Тогда:
$ x_n < 1 + 1 + 1/(2!) + 1/(3!) + dots + 1/(n!) $
Вспомним, что для $k >= 2$ выполняется неравенство $k! >= 2^(k-1)$. Следовательно, $1/(k!) <= 1/(2^(k-1))$.
Воспользуемся этим для оценки суммы:
$ x_n < 1 + 1 + 1/2 + 1/4 + 1/8 + dots + 1/(2^(n-1)) $
В правой части, начиная со второго слагаемого, мы видим сумму геометрической прогрессии:
$ x_n < 1 + ( 1 - (1/2)^n ) / (1 - 1/2) = 1 + 2 (1 - (1/2)^n ) < 1 + 2 = 3 $
*Вывод:* $x_n$ ограничена сверху числом $3$ (на самом деле она никогда не превышает $2.72$).

*Заключение:*
Так как последовательность $x_n$ монотонно возрастает и ограничена сверху, то по теореме Вейерштрасса она имеет конечный предел. Этот предел и называется числом $e$.
]

#note("Интересный факт", [
  Из этого доказательства сразу видно, что $2 < e <= 3$. База $x_1 = 2$, и так как она растет, $e$ точно больше 2. А из оценки сверху мы получили, что $e$ не больше 3.
])


#definition[
  Предел последовательности $(1 + 1/n)^n$ при $n arrow.r infinity$ называется *числом Эйлера* и обозначается $e$.
  $ e = lim_(n arrow.r infinity) (1 + 1/n)^n approx 2.71828... $
]

== Теорема об отделимости от нуля

#theorem[
  Если $lim_(n arrow.r infinity) a_n = A$ и $A != 0$, то найдутся число $c > 0$ и номер $N$, такие что для всех $n > N$ выполняется:
  $ |a_n| > c $
]

#proof[
  Возьмем $epsilon = (|A|) / 2$. Так как $A != 0$, то $epsilon > 0$.
  По определению предела, $exists N : forall n > N => |a_n - A| < (|A|) / 2$.
  Используя неравенство треугольника $|A| - |a_n| <= |a_n - A|$, получаем:
  $ |A| - |a_n| < (|A|) / 2 quad arrow.r.double quad |a_n| > (|A|) / 2 $
  Положив $c = (|A|) / 2$, получаем требуемое.
]

#pagebreak()

== Арифметические свойства предела

#theorem[
  Пусть последовательности $(a_n)$ и $(b_n)$ сходятся, и 
  $lim_(n arrow.r infinity) a_n = A, quad lim_(n arrow.r infinity) b_n = B$. 
  Тогда:
  1. $lim_(n arrow.r infinity) (a_n plus.minus b_n) = A plus.minus B$
  2. $lim_(n arrow.r infinity) (a_n dot b_n) = A dot B$
  3. $lim_(n arrow.r infinity) (a_n / b_n) = A / B$, при условии $B != 0$ и $b_n != 0$.
]

#proof[
  (Для суммы) 
  Возьмем произвольное $epsilon > 0$. 
  Нам нужно найти такой номер $N$, что $|(a_n + b_n) - (A + B)| < epsilon$.
  Используем неравенство треугольника:
  $ |(a_n + b_n) - (A + B)| = |(a_n - A) + (b_n - B)| <= |a_n - A| + |b_n - B| $
  Так как $a_n arrow.r A$, то для $epsilon/2 exists N_1: forall n > N_1 => |a_n - A| < epsilon/2$.
  Так как $b_n arrow.r B$, то для $epsilon/2 exists N_2: forall n > N_2 => |b_n - B| < epsilon/2$.
  Выбрав $N = max(N_1, N_2)$, получим:
  $ |(a_n + b_n) - (A + B)| < epsilon/2 + epsilon/2 = epsilon $
]

== Переход к пределу в неравенствах

#theorem[
  Пусть $lim a_n = A$ и $lim b_n = B$. 
  Если начиная с некоторого номера $N$ выполняется $a_n <= b_n$, то и $A <= B$.
]

#note("Осторожно!", [
  Если $a_n < b_n$, это *не гарантирует* $A < B$. 
  Пример: $a_n = 0$, $b_n = 1/n$. Всегда $0 < 1/n$, но их пределы равны: $0 = 0$.
])

#note("Теорема об отделимости от границ")[
  Если $a_n <= B$ для всех $n$, то $lim a_n <= B$. 
  Аналогично, если $a_n >= A$, то $lim a_n >= A$.
]
#pagebreak()

== Теорема о сжатой переменной

#note("Теорема о двух милиционерах")[
  Пусть даны три последовательности $(a_n), (b_n), (c_n)$, такие что:
  1. $a_n <= b_n <= c_n$ для всех $n > N_0$.
  2. $lim_(n arrow.r infinity) a_n = lim_(n arrow.r infinity) c_n = A$.
  Тогда последовательность $(b_n)$ также сходится, и $lim_(n arrow.r infinity) b_n = A$.
]

#proof[
  Зафиксируем $epsilon > 0$. 
  Так как $a_n arrow.r A$, то для всех $n > N_1$ имеем $A - epsilon < a_n$.
  Так как $c_n arrow.r A$, то для всех $n > N_2$ имеем $c_n < A + epsilon$.
  Пусть $N = max(N_0, N_1, N_2)$. Тогда для всех $n > N$ выполняется цепочка:
  $ A - epsilon < a_n <= b_n <= c_n < A + epsilon $
  Следовательно, $A - epsilon < b_n < A + epsilon$, что означает $|b_n - A| < epsilon$.
]

== Подпоследовательности

#definition[
  Пусть дана последовательность $(a_n)$. Если мы выберем бесконечную возрастающую последовательность натуральных индексов $n_1 < n_2 < n_3 < dots$, то последовательность $(a_(n_k))$ называется *подпоследовательностью* последовательности $(a_n)$.
]

#theorem[
  Если последовательность $(a_n)$ сходится к $A$, то любая её подпоследовательность также сходится к $A$.
]

#proof[
  Так как $n_k$ — возрастающая последовательность натуральных чисел, то $n_k >= k$. 
  Поскольку $a_n arrow.r A$, то для любого $epsilon > 0$ существует номер $N$, такой что при $n > N$ выполняется $|a_n - A| < epsilon$.
  Тогда для любого $k > N$ индекс $n_k >= k > N$, а значит $|a_(n_k) - A| < epsilon$. 
  Следовательно, $a_(n_k) arrow.r A$.
]
#pagebreak()

== Теорема Больцано — Вейерштрасса

#theorem[
  Из любой ограниченной последовательности можно выделить сходящуюся подпоследовательность.
]

#proof[
  1. Раз последовательность $(a_n)$ ограничена, все её члены лежат в некотором отрезке $[M_1, M_2]$.
  2. Разделим отрезок пополам. В одной из половин содержится бесконечно много членов последовательности. Выберем её и назовем $[a_1, b_1]$.
  3. Повторяем процесс: делим $[a_k, b_k]$ пополам и выбираем ту часть, где бесконечно много членов.
  4. Получаем систему вложенных отрезков, длины которых стремятся к 0. По лемме Кантора существует единственная точка $c$, принадлежащая всем отрезкам.
  5. Выбирая на каждом шаге по одному члену последовательности $a_(n_k)$ из соответствующего отрезка, мы получим подпоследовательность, которая стремится к $c$.
]

== Понятие бесконечных пределов

#definition[
  Говорят, что $lim_(n arrow.r infinity) a_n = +infinity$, если для любого $E > 0$ (сколь угодно большого) найдется номер $N$, такой что для всех $n > N$:
  $ a_n > E $
]

#note("Важно", [
  Если последовательность имеет бесконечный предел, она считается *расходящейся* (в строгом смысле слова "сходимость" зарезервирована для конечных чисел).
])

#pagebreak()

== Теорема о частичных пределах

#theorem[
  Для любой ограниченной последовательности $(a_n)$:
  1. Множество её частичных пределов $E$ непусто.
  2. Множество $E$ ограничено.
  3. Существуют $\max E$ и $\min E$.
]

#proof[
  *1. Непустота.* 
  Так как последовательность $(a_n)$ ограничена, то по теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $(a_(n_k))$. Предел этой подпоследовательности по определению является частичным пределом. Значит, $E != emptyset$.

  *2. Ограниченность.* 
  Так как $(a_n)$ ограничена, то существует такое $M$, что $forall n: |a_n| <= M$. Любой частичный предел $A$ как предел подпоследовательности тоже будет удовлетворять неравенству $|A| <= M$ (по теореме о переходе к пределу в неравенствах). Значит, множество $E$ ограничено.

  *3. Наличие максимума (для $limsup$).*
  Пусть $S = sup E$. Докажем, что $S in E$ (то есть $S$ сам является частичным пределом).
  
  Для этого нам нужно построить подпоследовательность, сходящуюся к $S$:
  - Для $epsilon = 1$ в окрестности $(S-1, S+1)$ лежит хотя бы один частичный предел, а значит, и бесконечно много членов исходной последовательности. Возьмем один из них $a_(n_1)$.
  - Для $epsilon = 1/2$ в окрестности $(S-1/2, S+1/2)$ аналогично выберем $a_(n_2)$ с индексом $n_2 > n_1$.
  - Продолжая для $epsilon = 1/k$, мы получим подпоследовательность $(a_(n_k))$, такую что $|a_(n_k) - S| < 1/k$.
  
  По теореме о зажатой переменной $a_(n_k) arrow.r S$. Значит $S in E$. Следовательно, $sup E = max E$. 
  (Для $inf E = min E$ доказывается аналогично).
]

#note("Важное следствие", [
  Число $A$ является пределом последовательности ($A = lim a_n$) тогда и только тогда, когда:
  $ liminf_{n arrow.r infinity} a_n = limsup_{n arrow.r infinity} a_n = A $
  То есть, когда все "пути", по которым можно идти внутри последовательности, ведут в одну и ту же точку.
])

#pagebreak()

== Сравнение скорости роста последовательностей

Пусть $n arrow.r infinity$. Введем иерархию роста (каждая следующая функция растет "быстрее" предыдущей):

$ ln n quad << quad n^alpha (alpha>0) quad << quad a^n (a>1) quad << quad n! quad << quad n^n $

#note("Что это значит на практике?", [
  Если в дроби в числителе стоит "слабая" функция, а в знаменателе "сильная", то предел равен 0.
  Например:
  1. $lim_(n arrow.r infinity) (ln n) / n^alpha = 0$
  2. $lim_(n arrow.r infinity) n^k / a^n = 0 quad (a > 1)$
  3. $lim_(n arrow.r infinity) a^n / (n!) = 0$
  4. $lim_(n arrow.r infinity) (n!) / n^n = 0$
])

#note("Пример доказательства (экспонента vs факториал)")[
  $lim_(n arrow.r infinity) a^n / (n!) = 0$ для любого $a > 0$.
]
#proof[
  Пусть $x_n = a^n / (n!)$. Рассмотрим отношение соседних членов:
  $ x_(n+1) / x_n = (a^(n+1) / ((n+1)!)) / (a^n / (n!)) = a / (n+1) $
  Начиная с некоторого номера $n > 2a$, это отношение будет меньше $1/2$.
  Значит, $x_n$ убывает и ограничена снизу нулем. По теореме Вейерштрасса предел существует. 
  Пусть $lim x_n = A$. Перейдем к пределу в равенстве $x_(n+1) = x_n dot a/(n+1)$:
  $ A = A dot 0 quad arrow.r.double quad A = 0. $
]
#pagebreak()

== Подпоследовательности

#definition[
  Пусть дана последовательность $(a_n)$. Рассмотрим строго возрастающую последовательность натуральных чисел:
  $ n_1 < n_2 < n_3 < dots < n_k < dots, quad n_k in NN $
  Тогда последовательность $(a_(n_k))$, составленная из членов исходной последовательности с этими индексами, называется *подпоследовательностью* $(a_n)$.
]

#note("Интуиция", [
  Ты просто "вычеркиваешь" некоторые члены из исходного ряда, но оставшиеся берешь в том же порядке, в котором они шли изначально. Главное — их должно остаться бесконечно много.
])

== Теорема о подпоследовательности сходящейся последовательности

#theorem[
  Если последовательность $(a_n)$ сходится к пределу $A$ (конечному или бесконечному), то любая её подпоследовательность $(a_(n_k))$ также сходится к $A$.
]

#proof[
  Рассмотрим случай конечного предела $A$.
  1. Так как $lim_(n arrow.r infinity) a_n = A$, то для любого $epsilon > 0$ существует номер $N$, такой что:
     $ forall n > N => |a_n - A| < epsilon $
  2. Заметим важное свойство индексов: так как $n_k$ — строго возрастающая последовательность натуральных чисел, то $n_k >= k$ для любого $k$.
  3. Тогда, если мы выберем $k > N$, то автоматически $n_k >= k > N$.
  4. Следовательно, для всех $k > N$ выполняется:
     $ |a_(n_k) - A| < epsilon $
  А это по определению означает, что $lim_(k arrow.r infinity) a_(n_k) = A$.
]

#note("Практическое применение", [
  Эту теорему чаще всего используют, чтобы доказать *отсутствие* предела. 
  Если у последовательности есть две подпоследовательности, стремящиеся к *разным* пределам, то сама последовательность предела не имеет. 
  
  *Пример:* $a_n = (-1)^n$. 
  Подпоследовательность $a_(2k) = 1 arrow.r 1$. 
  Подпоследовательность $a_(2k-1) = -1 arrow.r -1$. 
  Пределы разные $=> lim a_n$ не существует.
])

== Теорема Больцано — Вейерштрасса

#theorem[
  Из любой ограниченной последовательности можно выделить сходящуюся подпоследовательность.
]

#proof[
  Пусть $(a_n)$ ограничена, то есть все её члены лежат на некотором отрезке $[a, b]$. 
  Применим метод "деления пополам":
  1. Разделим $[a, b]$ пополам. Хотя бы в одной из половин (обозначим её $I_1$) содержится бесконечное число членов последовательности. Выберем любой $a_(n_1) in I_1$.
  2. Разделим $I_1$ пополам. Снова выберем ту половину ($I_2$), где бесконечно много членов. Выберем $a_(n_2) in I_2$ так, чтобы $n_2 > n_1$.
  3. Продолжая процесс, мы получим систему вложенных отрезков $I_1 supset I_2 supset dots$, длины которых $d_k = (b-a)/2^k arrow.r 0$. 
  4. По лемме Кантора существует единственная точка $c$, общая для всех отрезков. 
  5. Так как $|a_(n_k) - c| <= d_k$, а $d_k arrow.r 0$, то по теореме о зажатой переменной $a_(n_k) arrow.r c$.
  Мы построили сходящуюся подпоследовательность.
]

#pagebreak()

== Понятия бесконечных пределов

Введем определения для случаев, когда последовательность "уходит в бесконечность":

#definition[
  1. $lim_(n arrow.r infinity) a_n = +infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double a_n > E$.
  2. $lim_(n arrow.r infinity) a_n = -infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double a_n < -E$.
  3. $lim_(n arrow.r infinity) a_n = infinity$, если $forall E > 0 space exists N in NN : forall n > N arrow.r.double |a_n| > E$.
]

#note("Важно", [
  Если последовательность имеет бесконечный предел, она называется *расходящейся* к бесконечности.
])

== Частичные пределы. Верхний и нижний пределы

#definition[
  Число $A$ (или символ $plus.minus infinity$) называется *частичным пределом* последовательности $(a_n)$, если существует подпоследовательность $(a_(n_k))$, сходящаяся к $A$.
]

#note("О структуре множества частичных пределов")[
  Для любой последовательности множество её частичных пределов (обозначим $E$) непусто (если допускать бесконечные пределы). В этом множестве всегда есть наибольший и наименьший элементы.
]

#definition[
  - *Верхний предел* ($limsup a_n$ или $overline(lim) a_n$) — это наибольший из частичных пределов.
  - *Нижний предел* ($liminf a_n$ или $underline(lim) a_n$) — это наименьший из частичных пределов.
]

#note("Критерий существования предела", [
  Последовательность имеет предел (конечный или бесконечный) тогда и только тогда, когда её верхний и нижний пределы совпадают:
  $ liminf_{n arrow.r infinity} a_n = limsup_{n arrow.r infinity} a_n = lim_{n arrow.r infinity} a_n $
])

== Фундаментальные последовательности

#definition[
  Последовательность $(a_n)$ называется *фундаментальной* (или последовательностью Коши), если для любого $epsilon > 0$ существует такой номер $N$, что для любых индексов $n, m > N$ выполняется неравенство:
  $ |a_n - a_m| < epsilon $
]

#note("В чем фишка?", [
  В определении обычного предела нам нужно знать число $A$. В определении фундаментальности нам нужно знать только сами члены последовательности. Если они "сгущаются" друг к другу на бесконечности, значит, они фундаментальны.
])

== Критерий Коши

#note("Критерий Коши")[
  Для того чтобы последовательность $(a_n)$ имела конечный предел, необходимо и достаточно, чтобы она была фундаментальной.
]

#proof[
  *1. Необходимость ($arrow.r.double$):*
  Пусть $lim a_n = A$. Тогда для $epsilon/2$ существует номер $N$, такой что при $n, m > N$:
  $ |a_n - A| < epsilon/2 quad "и" quad |a_m - A| < epsilon/2 $
  По неравенству треугольника:
  $ |a_n - a_m| = |(a_n - A) - (a_m - A)| <= |a_n - A| + |a_m - A| < epsilon/2 + epsilon/2 = epsilon $
  Следовательно, последовательность фундаментальна.

  *2. Достаточность ($arrow.l.double$):*
  Пусть $(a_n)$ фундаментальна.
  - Сначала докажем, что она *ограничена*. Возьмем $epsilon = 1$, тогда $forall n > N: |a_n - a_(N+1)| < 1$. Все члены после $N$ зажаты в окрестности $a_(N+1)$, значит, вся последовательность ограничена.
  - По теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $a_(n_k) arrow.r A$.
  - Докажем, что и вся последовательность стремится к $A$. 
    $ |a_n - A| <= |a_n - a_(n_k)| + |a_(n_k) - A| $
    Первое слагаемое можно сделать меньше $epsilon/2$ из-за фундаментальности (так как $n$ и $n_k$ велики), второе — из-за сходимости подпоследовательности.
    Значит, $a_n arrow.r A$.
]

== Примеры применения критерия Коши

#note("Расходимость гармонической последовательности")[
  Последовательность частичных сумм $S_n = sum_(k=1)^n 1/k$ расходится.
]

#proof[
  Воспользуемся отрицанием критерия Коши. Нам нужно показать, что:
  $ exists epsilon > 0 : forall N, exists n, m > N => |S_m - S_n| >= epsilon $
  
  Пусть $m = 2n$. Рассмотрим разность:
  $ |S_(2n) - S_n| = 1/(n+1) + 1/(n+2) + dots + 1/(2n) $
  В этой сумме $n$ слагаемых, и каждое из них не меньше самого маленького ($1/(2n)$):
  $ |S_(2n) - S_n| >= n dot 1/(2n) = 1/2 $
  Мы нашли такое $epsilon = 1/2$, что какую бы далекую часть ряда мы ни взяли, мы всегда можем найти кусок, сумма которого больше $1/2$. 
  Значит, последовательность не фундаментальна, а следовательно — расходится.
]

= Предел и непрерывность функций

== Топология вещественной прямой

Пусть $X subset RR$ — некоторое числовое множество.

#definition[
  1. *Внутренняя точка:* Точка $x in X$ называется внутренней, если она входит в $X$ вместе с некоторой своей $epsilon$-окрестностью: $exists epsilon > 0: (x-epsilon, x+epsilon) subset X$.
  2. *Предельная точка:* Точка $a$ (не обязательно из $X$) называется предельной для $X$, если в любой её $epsilon$-окрестности содержится хотя бы одна точка из $X$, отличная от $a$. (Эквивалентно: бесконечно много точек из $X$).
  3. *Изолированная точка:* Точка $x in X$, которая не является предельной.
  4. *Граничная точка:* Точка, в любой окрестности которой есть как точки из $X$, так и точки, не принадлежащие $X$.
]

#definition[
  - Множество называется *открытым*, если все его точки — внутренние.
  - Множество называется *замкнутым*, если оно содержит все свои предельные точки.
]

#note("Примеры", [
  - Интервал $(0, 1)$ — открытое множество.
  - Отрезок $[0, 1]$ — замкнутое множество (содержит свои границы $0$ и $1$).
  - Полуинтервал $[0, 1)$ — ни то, ни другое.
])

#pagebreak()
== Предел функции по Гейне (на языке последовательностей)

Пусть функция $f(x)$ определена в некоторой окрестности точки $a$, за исключением, быть может, самой точки $a$.

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любой последовательности $(x_n)$, такой что:
  1. $x_n arrow.r a$ при $n arrow.r infinity$;
  2. $x_n != a$ (члены последовательности лежат в проколотой окрестности);
  соответствующая последовательность значений функции сходится к $A$:
  $ f(x_n) arrow.r A $
]

Записывается: $lim_(x arrow.r a) f(x) = A$.

== Предел функции по Гейне (на языке последовательностей)

Пусть функция $f(x)$ определена в некоторой окрестности точки $a$, за исключением, быть может, самой точки $a$.

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любой последовательности $(x_n)$, такой что:
  1. $x_n arrow.r a$ при $n arrow.r infinity$;
  2. $x_n != a$ (члены последовательности лежат в проколотой окрестности);
  соответствующая последовательность значений функции сходится к $A$:
  $ f(x_n) arrow.r A $
]

Записывается: $lim_(x arrow.r a) f(x) = A$.

#pagebreak()

== Свойства предела функции

#theorem[
  Если пределы $lim_(x arrow.r a) f(x) = A$ и $lim_(x arrow.r a) g(x) = B$ существуют, то:
  1. *Единственность:* Предел функции в точке единственен.
  2. *Арифметика:* $lim (f plus.minus g) = A plus.minus B$, $lim (f dot g) = A dot B$, $lim (f/g) = A/B$ (при $B != 0$).
  3. *Переход к пределу в неравенствах:* Если $f(x) <= g(x)$ в окрестности $a$, то $A <= B$.
  4. *Теорема о зажатой функции:* Если $f(x) <= h(x) <= g(x)$ и $f, g arrow.r A$, то $h(x) arrow.r A$.
]

== Предел сложной функции

#theorem[
  Пусть $lim_(x arrow.r a) g(x) = b$ и $lim_(y arrow.r b) f(y) = A$. 
  Если в некоторой проколотой окрестности точки $a$ выполняется $g(x) != b$, то:
  $ lim_(x arrow.r a) f(g(x)) = A $
]

== Определение предела по Коши (на языке $epsilon - delta$)

#definition[
  Число $A$ называется *пределом функции $f(x)$ в точке $a$*, если для любого $epsilon > 0$ найдется такое $delta > 0$ (зависящее от $epsilon$), что для всех $x$, удовлетворяющих условию $0 < |x - a| < delta$, выполняется неравенство:
  $ |f(x) - A| < epsilon $
]

#align(center)[
  $ lim_(x arrow.r a) f(x) = A quad <=> quad forall epsilon > 0 space exists delta > 0 : space forall x in dot(U)_delta (a) arrow.r.double f(x) in U_epsilon (A) $
]

#note([Что такое $dot(U)_delta (a)$?], [
  Это *проколотая* дельта-окрестность точки $a$. Условие $0 < |x - a|$ как раз исключает саму точку $a$. Нам не важно, что происходит в самой точке (функция там может быть даже не определена), нам важно, что происходит *рядом*.
])

=== Предел в бесконечности
Если точка $a$ или предел $A$ являются бесконечными, определение слегка меняется:
- $lim_(x arrow.r infinity) f(x) = A$: $forall epsilon > 0 space exists M > 0 : forall x : |x| > M => |f(x) - A| < epsilon$.
- $lim_(x arrow.r a) f(x) = infinity$: $forall E > 0 space exists delta > 0 : forall x : 0 < |x - a| < delta => |f(x)| > E$.

== Теорема о равносильности определений

#theorem[
  Определения предела функции по Гейне и по Коши эквивалентны.
]

#proof[
  *1. Коши $arrow.r.double$ Гейне:*
  Пусть предел по Коши существует. Возьмем любую $x_n arrow.r a$. По определению Коши, для $epsilon$ есть $delta$, в которую рано или поздно попадут все $x_n$ (начиная с номера $N$). Значит, $f(x_n)$ попадет в $epsilon$-окрестность $A$. Сходимость есть.

  *2. Гейне $arrow.r.double$ Коши (от противного):*
  Предположим, что определение Коши не выполняется. Тогда существует такое "плохое" $epsilon$, что для любого $delta_n = 1/n$ найдется точка $x_n$, которая лежит в $delta_n$-окрестности $a$, но $f(x_n)$ лежит вне $epsilon$-окрестности $A$. 
  Мы построили последовательность $x_n arrow.r a$, для которой $f(x_n) arrow.not.r A$. Это противоречит определению Гейне.
]

== Свойства предела функции (локальные)

#note("О локальной ограниченности")[
  Если функция имеет конечный предел в точке $a$, то она ограничена в некоторой проколотой окрестности этой точки.
]

#note("Об отделимости от нуля")[
  Если $lim_(x arrow.r a) f(x) = A$ и $A != 0$, то существует такая окрестность точки $a$, в которой значения функции имеют тот же знак, что и $A$, и отделены от нуля:
  $ exists delta > 0, exists c > 0 : forall x in dot(U)_delta (a) => |f(x)| > c $
]

== Замечательные пределы

#grid(
  columns: (1fr, 1fr),
  gutter: 20pt,
  note("Первый замечательный", [
    $ lim_(x arrow.r 0) (sin x) / x = 1 $
    Раскрывает неопределенность $0/0$ для тригонометрии.
  ]),
  note("Второй замечательный", [
    $ lim_(x arrow.r infinity) (1 + 1/x)^x = e $
    Или в форме $x arrow.r 0$: $lim_(x arrow.r 0) (1 + x)^(1/x) = e$.
  ])
)

== Односторонние пределы

#definition[
  1. *Предел слева:* Число $A$ называется пределом функции $f(x)$ в точке $a$ слева, если для любого $epsilon > 0$ существует $delta > 0$, такое что для всех $x in (a - delta, a)$ выполняется $|f(x) - A| < epsilon$.
     Обозначение: $lim_(x arrow.r a - 0) f(x) = f(a-0) = A$.
  
  2. *Предел справа:* Аналогично, но для $x in (a, a + delta)$.
     Обозначение: $lim_(x arrow.r a + 0) f(x) = f(a+0) = A$.
]

== Критерий существования предела

#theorem[
  Предел функции $f(x)$ в точке $a$ существует тогда и только тогда, когда существуют оба односторонних предела и они равны между собой:
  $ lim_(x arrow.r a) f(x) = A quad <=> quad f(a-0) = f(a+0) = A $
]

#note("Зачем это нужно?", [
  Если пределы слева и справа существуют, но не равны, в этой точке у функции происходит "скачок" (разрыв первого рода).
])

#pagebreak()

== Бесконечно малые и бесконечно большие функции

#definition[
  Функция $alpha(x)$ называется *бесконечно малой* (б.м.) при $x arrow.r a$, если $lim_(x arrow.r a) alpha(x) = 0$.
]

#definition[
  Функция $f(x)$ называется *бесконечно большой* (б.б.) при $x arrow.r a$, если $lim_(x arrow.r a) |f(x)| = +infinity$.
]

=== Свойства бесконечно малых
1. Сумма конечного числа б.м. функций есть б.м. функция.
2. Произведение б.м. функции на ограниченную функцию есть б.м. функция.
3. Произведение двух б.м. функций есть б.м. функция.

=== Лемма о связи б.б. и б.м.
#theorem[
  Если $f(x)$ — бесконечно большая функция при $x arrow.r a$, то $1/f(x)$ — бесконечно малая функция в этой точке (и наоборот, если б.м. функция не обращается в ноль в окрестности $a$).
]

== Представление функции через бесконечно малую

#theorem[
  Число $A$ является пределом функции $f(x)$ в точке $a$ тогда и только тогда, когда функцию можно представить в виде:
  $ f(x) = A + alpha(x) $
  где $alpha(x)$ — бесконечно малая функция при $x arrow.r a$.
]

== Связь бесконечно больших и бесконечно малых функций

#lemma[
  1. Если функция $f(x)$ является бесконечно большой при $x arrow.r a$, то функция $1/f(x)$ является бесконечно малой при $x arrow.r a$.
  2. Если функция $alpha(x)$ является бесконечно малой при $x arrow.r a$ и $alpha(x) != 0$ в некоторой проколотой окрестности точки $a$, то функция $1/alpha(x)$ является бесконечно большой при $x arrow.r a$.
]

#proof[
  Докажем первый пункт. Пусть $f(x)$ — б.б. при $x arrow.r a$. 
  По определению, для любого (сколь угодно большого) числа $E > 0$ существует $delta > 0$, такое что:
  $ forall x in dot(U)_delta (a) arrow.r.double |f(x)| > E $
  Рассмотрим произвольное $epsilon > 0$. Положим $E = 1/epsilon$. Тогда найдется такое $delta$, что:
  $ |f(x)| > 1/epsilon quad <=> quad 1/(|f(x)|) < epsilon $
  Это в точности означает, что $1/f(x)$ — бесконечно малая функция. Второй пункт доказывается аналогично переходом от $epsilon$ к $E = 1/epsilon$.
]

#pagebreak()
== Критерий существования конечного предела в терминах б.м.

#theorem[
  Число $A$ является пределом функции $f(x)$ в точке $a$ тогда и только тогда, когда функцию в окрестности точки $a$ можно представить в виде:
  $ f(x) = A + alpha(x) $
  где $alpha(x)$ — бесконечно малая функция при $x arrow.r a$.
]

#proof[
  *Необходимость ($arrow.r.double$):*
  Пусть $lim_(x arrow.r a) f(x) = A$. Положим $alpha(x) = f(x) - A$. 
  Тогда $lim_(x arrow.r a) alpha(x) = lim_(x arrow.r a) (f(x) - A) = A - A = 0$. 
  Значит, $alpha(x)$ — б.м. по определению, и $f(x) = A + alpha(x)$.

  *Достаточность ($arrow.l.double$):*
  Пусть $f(x) = A + alpha(x)$, где $lim_(x arrow.r a) alpha(x) = 0$. 
  По свойствам пределов (предел константы равен константе, предел суммы равен сумме пределов):
  $ lim_(x arrow.r a) f(x) = lim_(x arrow.r a) (A + alpha(x)) = lim_(x arrow.r a) A + lim_(x arrow.r a) alpha(x) = A + 0 = A $
  Значит, предел функции равен $A$.
]

#note("💡 Почему это важно?", [
  Это представление — первый шаг к понятию *дифференцируемости*. Позже мы увидим, что если приращение функции можно представить как $Delta f = L dot Delta x + alpha(Delta x) dot Delta x$, то функция дифференцируема. Мы заменяем сложную функцию на простую линейную часть плюс "малый мусор".
])

== Непрерывность функции в точке

#definition[
  Функция $f(x)$ называется *непрерывной в точке $a$*, если выполнены следующие три условия:
  1. Функция определена в точке $a$ (существует $f(a)$).
  2. Существует конечный предел $lim_(x arrow.r a) f(x)$.
  3. Этот предел равен значению функции в точке: $lim_(x arrow.r a) f(x) = f(a)$.
]

== Теорема о равносильности трех формулировок

Для функции $f(x)$, определенной в окрестности точки $a$, следующие три определения непрерывности эквивалентны:

#axiom_block("1. На языке пределов", [
  $ lim_(x arrow.r a) f(x) = f(a) $
])

#axiom_block("2. На языке «эпсилон-дельта» (по Коши)", [
  $ forall epsilon > 0 space exists delta > 0 : space forall x in U_delta (a) arrow.r.double |f(x) - f(a)| < epsilon $
  *(Заметим, что здесь окрестность НЕ проколотая, так как при $x=a$ неравенство $0 < epsilon$ верно автоматически).*
])

#axiom_block("3. На языке приращений", [
  Пусть $Delta x = x - a$ — приращение аргумента, а $Delta f = f(a + Delta x) - f(a)$ — приращение функции. Тогда:
  $ lim_(Delta x arrow.r 0) Delta f = 0 $
])

#proof[
  *1 <=> 2:* Это прямое следствие эквивалентности определений предела по Коши и Гейне, с учетом того, что предел равен $f(a)$. Единственное отличие от стандартного определения предела — мы включаем саму точку $a$ в рассмотрение (поэтому $|x-a| < delta$ вместо $0 < |x-a| < delta$).

  *1 <=> 3:* 
  Запишем $lim_(x arrow.r a) f(x) = f(a)$ в другом виде. 
  Пусть $x = a + Delta x$. Тогда условие $x arrow.r a$ эквивалентно $Delta x arrow.r 0$. 
  $ lim_(Delta x arrow.r 0) f(a + Delta x) = f(a) $
  Перенесем $f(a)$ в левую часть под знак предела:
  $ lim_(Delta x arrow.r 0) (f(a + Delta x) - f(a)) = 0 $
  Что по определению приращения есть $lim_(Delta x arrow.r 0) Delta f = 0$.
]

#pagebreak()
== Локальные свойства непрерывных функций

Пусть функции $f(x)$ и $g(x)$ непрерывны в точке $a$.

#note("Арифметические свойства")[
  Следующие функции также будут непрерывны в точке $a$:
  1. $f(x) plus.minus g(x)$ (Сумма и разность).
  2. $f(x) dot g(x)$ (Произведение).
  3. $f(x) / g(x)$, если $g(a) != 0$ (Частное).
]

#proof[
  Так как функции непрерывны, то $lim_(x arrow.r a) f(x) = f(a)$ и $lim_(x arrow.r a) g(x) = g(a)$. 
  По арифметическим свойствам пределов:
  $ lim_(x arrow.r a) (f(x) + g(x)) = lim f(x) + lim g(x) = f(a) + g(a) $
  Что и означает непрерывность суммы в точке $a$. Для остальных операций доказательство аналогично.
]

#note("Локальная ограниченность")[
  Если функция $f(x)$ непрерывна в точке $a$, то она ограничена в некоторой окрестности этой точки.
]

#note("Сохранение знака")[
  Если функция $f(x)$ непрерывна в точке $a$ и $f(a) != 0$, то существует такая окрестность $U_delta (a)$, в которой для всех $x$ знак функции совпадает со знаком $f(a)$.
]

#proof[
  Пусть для определенности $f(a) > 0$. 
  Возьмем в определении непрерывности по Коши $epsilon = f(a)/2 > 0$. 
  Тогда существует $delta > 0$, такое что для всех $x in U_delta (a)$:
  $ |f(x) - f(a)| < f(a)/2 quad arrow.r.double quad f(a) - f(a)/2 < f(x) < f(a) + f(a)/2 $
  Отсюда $f(x) > f(a)/2 > 0$, то есть знак функции положителен во всей окрестности.
]

#note("Непрерывность сложной функции")[
  Если функция $g(x)$ непрерывна в точке $a$, а функция $f(y)$ непрерывна в точке $b = g(a)$, то сложная функция $h(x) = f(g(x))$ непрерывна в точке $a$.
]

#pagebreak()
== Глобальные свойства непрерывных функций

Все следующие теоремы рассматривают функцию $f(x)$, которая непрерывна в каждой точке отрезка $[a, b]$. В матане это записывается как $f in C[a, b]$.

=== Теоремы Вейерштрасса

#note("Первая теорема Вейерштрасса")[
  Если функция непрерывна на отрезке $[a, b]$, то она ограничена на этом отрезке.
]

#proof[
  Докажем от противного. Пусть $f(x)$ не ограничена сверху. Тогда для каждого $n in NN$ найдется такая точка $x_n in [a, b]$, что $f(x_n) > n$. 
  Мы получили последовательность $(x_n)$. Так как она лежит в отрезке, то по теореме Больцано-Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $x_(n_k) arrow.r c$. 
  Так как отрезок замкнут, то $c in [a, b]$. В силу непрерывности $f(x_(n_k)) arrow.r f(c)$. 
  Но по нашему построению $f(x_(n_k)) > n_k arrow.r infinity$. 
  Противоречие: предел не может быть одновременно числом $f(c)$ и бесконечностью.
]

#note("Вторая теорема Вейерштрасса")[
  Если функция непрерывна на отрезке $[a, b]$, то она достигает на нем своих точных верхней и нижней граней (своего максимума и минимума).
]

#note("Суть", [
  Это значит, что существуют такие точки $x_min, x_max in [a, b]$, что:
  $ f(x_min) = inf_{x in [a, b]} f(x) quad "и" quad f(x_max) = sup_{x in [a, b]} f(x) $
])

=== Теоремы Больцано — Коши

#note("Первая теорема Больцано — Коши")[
  Если функция непрерывна на отрезке $[a, b]$ и на его концах принимает значения разных знаков (т.е. $f(a) dot f(b) < 0$), то внутри отрезка найдется хотя бы одна точка $c in (a, b)$, в которой $f(c) = 0$.
]

#proof[
  (Метод деления отрезка пополам). 
  1. Делим $[a, b]$ пополам точкой $x_0$. Если $f(x_0)=0$, точка найдена.
  2. Если нет, выбираем ту половину, на концах которой знаки функции разные. 
  3. Повторяя процесс, строим систему вложенных отрезков, стремящихся к точке $c$. По непрерывности $f(c)$ должна быть одновременно $<= 0$ и $>= 0$ (как предел левых и правых концов). Значит, $f(c) = 0$.
]

#note("Вторая теорема Больцано — Коши (о промежуточных значениях)")[
  Если функция непрерывна на $[a, b]$, то она принимает любое промежуточное значение между $f(a)$ и $f(b)$.
]

#note("Пример", [
  Если $f(a) = 1$, а $f(b) = 5$, то для любого числа $C$ между ними (например, $C=3$) найдется точка на отрезке, где $f(x) = 3$.
])

== Лемма о замкнутости отрезка

#lemma[
  Если последовательность точек $x_n$ принадлежит отрезку $[a, b]$ и $x_n arrow.r c$, то предельная точка $c$ также принадлежит этому отрезку ($c in [a, b]$).
]

Это свойство замкнутости критически важно для доказательства теорем Вейерштрасса. Для интервала $(a, b)$ это неверно: последовательность $1/n$ лежит в $(0, 1)$, но её предел $0$ не принадлежит интервалу.

#pagebreak()

== Глобальные свойства: Теоремы Вейерштрасса

Эти теоремы работают только на *компакте* (в нашем случае — на отрезке $[a, b]$). Если отрезок заменить на интервал, магия исчезнет.

#note("Первая теорема Вейерштрасса (об ограниченности)")[
  Если функция $f(x)$ непрерывна на отрезке $[a, b]$, то она ограничена на этом отрезке.
]

#proof[
  Докажем от противного. Предположим, что функция $f(x)$ не ограничена сверху на $[a, b]$.
  1. Тогда для каждого $n in NN$ существует точка $x_n in [a, b]$ такая, что $f(x_n) > n$.
  2. Мы получили последовательность точек $(x_n)$, лежащую на отрезке $[a, b]$. 
  3. По теореме Больцано — Вейерштрасса из неё можно выделить сходящуюся подпоследовательность $(x_(n_k))$, стремящуюся к некоторой точке $c$.
  4. Так как отрезок замкнут, точка $c$ также принадлежит $[a, b]$.
  5. В силу непрерывности функции в точке $c$ имеем: $lim_(k arrow.r infinity) f(x_(n_k)) = f(c)$.
  6. Но по нашему построению $f(x_(n_k)) > n_k$, а значит $lim f(x_(n_k)) = +infinity$.
  Мы получили противоречие: предел не может быть одновременно числом $f(c)$ и бесконечностью. Значит, функция ограничена.
]

#note("Вторая теорема Вейерштрасса (о достижении экстремумов)")[
  Если функция $f(x)$ непрерывна на отрезке $[a, b]$, то она достигает на нем своих точных верхней и нижней граней.
  (То есть существуют точки $x_1, x_2 in [a, b]$ такие, что $f(x_1) = sup f$ и $f(x_2) = inf f$).
]

#proof[
  Докажем для верхней грани $M = sup_{x in [a, b]} f(x)$.
  1. По первой теореме Вейерштрасса функция ограничена, значит $M$ — конечное число.
  2. По определению точной верхней грани, для любого $n in NN$ найдется такая точка $x_n in [a, b]$, что:
     $ M - 1/n < f(x_n) <= M $
  3. Из последовательности $(x_n)$ снова выделяем подпоследовательность $(x_(n_k))$, сходящуюся к $c in [a, b]$.
  4. Перейдем к пределу в неравенстве $M - 1/n_k < f(x_(n_k)) <= M$ при $k arrow.r infinity$.
  5. По теореме о зажатой переменной $lim f(x_(n_k)) = M$.
  6. С другой стороны, в силу непрерывности $lim f(x_(n_k)) = f(c)$.
  Следовательно, $f(c) = M$. Точная верхняя грань достигнута в точке $c$.
]

== Первая теорема Больцано — Коши (о нуле функции)

#theorem[
  Пусть функция $f(x)$ непрерывна на отрезке $[a, b]$ и на его концах принимает значения разных знаков ($f(a) dot f(b) < 0$). 
  Тогда существует хотя бы одна точка $c in (a, b)$ такая, что $f(c) = 0$.
]

#proof[
  Воспользуемся методом деления отрезка пополам (дихотомией). 
  Пусть для определенности $f(a) < 0$ и $f(b) > 0$.

  1. Рассмотрим середину отрезка $x_1 = (a + b) / 2$. 
     - Если $f(x_1) = 0$, то точка $c = x_1$ найдена, и доказательство завершено.
     - Если $f(x_1) != 0$, то выберем из двух половин $[a, x_1]$ и $[x_1, b]$ ту, на концах которой функция принимает значения разных знаков. Обозначим этот новый отрезок $[a_1, b_1]$.

  2. Повторим процедуру для $[a_1, b_1]$, получим $[a_2, b_2]$, и так далее. 
     В результате либо на каком-то конечном шаге мы попадем в нуль, либо получим бесконечную систему вложенных отрезков $[a_n, b_n]$ таких, что:
     - $f(a_n) < 0, space f(b_n) > 0$ для всех $n$;
     - Длина отрезка $b_n - a_n = (b-a) / 2^n arrow.r 0$.

  3. По лемме Кантора о вложенных отрезках существует единственная точка $c$, принадлежащая всем отрезкам: $lim a_n = lim b_n = c$.
  
  4. В силу непрерывности функции в точке $c$:
     - $f(c) = lim_(n arrow.r infinity) f(a_n) <= 0$ (так как все $f(a_n) < 0$).
     - $f(c) = lim_(n arrow.r infinity) f(b_n) >= 0$ (так как все $f(b_n) > 0$).
  
  5. Из двух неравенств $f(c) <= 0$ и $f(c) >= 0$ следует, что $f(c) = 0$. 
  Теорема доказана.
]

#pagebreak()
== Вторая теорема Больцано — Коши (о промежуточных значениях)

#theorem[
  Пусть функция $f(x)$ непрерывна на отрезке $[a, b]$. Тогда она принимает любое значение $C$, лежащее между $f(a)$ и $f(b)$.
]

#proof[
  Пусть для определенности $f(a) < f(b)$ и выбрано произвольное число $C$, такое что $f(a) < C < f(b)$. 
  
  Рассмотрим вспомогательную функцию:
  $ g(x) = f(x) - C $
  
  1. Функция $g(x)$ непрерывна на отрезке $[a, b]$, так как она является разностью непрерывной функции и константы.
  2. Вычислим значения $g(x)$ на концах отрезка:
     - $g(a) = f(a) - C < 0$ (так как $C > f(a)$).
     - $g(b) = f(b) - C > 0$ (так как $C < f(b)$).
  3. Знаки функции $g(x)$ на концах отрезка различны. По *первой теореме Больцано — Коши*, существует точка $c in (a, b)$, такая что $g(c) = 0$.
  4. Это означает, что $f(c) - C = 0$, то есть $f(c) = C$.
  Теорема доказана.
]

#note("Следствие (об образе отрезка)", [
  Образом отрезка $[a, b]$ при непрерывном отображении также является отрезок. 
  Действительно, по теоремам Вейерштрасса функция достигает своего минимума $m$ и максимума $M$, а по второй теореме Больцано — Коши принимает все значения между ними. Таким образом, множество значений функции $f([a, b]) = [m, M]$.
])

#pagebreak()

== Классификация точек разрыва

#definition[
  Точка $a$ называется *точкой разрыва* функции $f(x)$, если функция определена в окрестности этой точки, но не является в ней непрерывной.
]

Разрывы делятся на два типа в зависимости от поведения односторонних пределов $f(a-0)$ и $f(a+0)$.

=== 1. Разрыв первого рода
Оба односторонних предела существуют и конечны.
- *Устранимый разрыв:* $f(a-0) = f(a+0) != f(a)$. (Пределы равны, но в самой точке "дырка" или значение "выбито").
- *Неустранимый разрыв (Скачок):* $f(a-0) != f(a+0)$. 

=== 2. Разрыв второго рода
Хотя бы один из односторонних пределов не существует или равен бесконечности.

#figure(
  image("pics/breakpoints.png", width: 80%),
  caption: [Точки устранимого разрыва и 1, 2 рода]
) <fig-razryv>

== Разрывы монотонной функции

#theorem[
  Если функция $f(x)$ монотонна на интервале $(a, b)$, то в любой точке этого интервала она:
  1. Либо непрерывна.
  2. Либо имеет разрыв *только первого рода* (скачок).
]

#proof[
  Пусть функция $f(x)$ возрастает. Рассмотрим точку $x_0 in (a, b)$.
  Для всех $x < x_0$ значения $f(x) <= f(x_0)$. Значит, множество значений функции слева ограничено сверху числом $f(x_0)$. 
  По принципу верхней грани существует $sup_{x < x_0} f(x)$, который и является левым пределом $f(x_0 - 0)$.
  Аналогично существует правый предел $f(x_0 + 0) = inf_{x > x_0} f(x)$.
  Так как пределы конечны, разрыв может быть только первого рода.
]

== Следствия из первого замечательного предела

Все пределы ниже рассматриваются при $x arrow.r 0$.

#grid(
  columns: (1fr, 1fr),
  gutter: 15pt,
  note("Для тангенса", [
    $ lim_(x arrow.r 0) (tg x) / x = 1 $
  ]),
  note("Для обратных функций", [
    $ lim_(x arrow.r 0) (arcsin x) / x = 1 $
    $ lim_(x arrow.r 0) (a r c t g x) / x = 1 $
  ])
)

#note("Следствие для косинуса")[
  $ lim_(x arrow.r 0) (1 - cos x) / x^2 = 1/2 $
]

#proof[
  Воспользуемся формулой двойного угла $1 - cos x = 2 sin^2 (x/2)$:
  $ lim_(x arrow.r 0) (2 sin^2 (x/2)) / x^2 = 2 dot lim_(x arrow.r 0) (sin (x/2) / x)^2 = 2 dot lim_(x arrow.r 0) (1/2 dot (sin(x/2) / (x/2)))^2 = 2 dot (1/2)^2 dot 1^2 = 1/2 $
]

== Следствия из второго замечательного предела

Все пределы ниже рассматриваются при $x arrow.r 0$.

#note("Логарифмическое и экспоненциальное", [
  1. $lim_(x arrow.r 0) (ln(1 + x)) / x = 1$
  2. $lim_(x arrow.r 0) (e^x - 1) / x = 1$
  3. $lim_(x arrow.r 0) (a^x - 1) / x = ln a$
])

#note("Следствие для степенной функции")[
  $ lim_(x arrow.r 0) ((1 + x)^alpha - 1) / x = alpha $
]

#proof[
  Используем основное логарифмическое тождество $(1+x)^alpha = e^(alpha ln(1+x))$:
  $ lim_(x arrow.r 0) (e^(alpha ln(1+x)) - 1) / x = lim_(x arrow.r 0) (e^(alpha ln(1+x)) - 1) / (alpha ln(1+x)) dot (alpha ln(1+x)) / x $
  Первая дробь стремится к 1 (следствие для $e^x$), вторая дробь стремится к $alpha dot 1$ (следствие для $ln$). 
  Итого: $1 dot alpha = alpha$.
]

== Таблица эквивалентных бесконечно малых

При $alpha(x) arrow.r 0$ справедливы следующие замены:

#align(center)[
#table(
  columns: (1fr, 1fr),
  stroke: none,
  fill: (x, y) => if calc.even(y) { gray.lighten(80%) },
  [*Функция*], [*Эквивалента*],
  $sin alpha(x)$, $alpha(x)$,
  $tg alpha(x)$, $alpha(x)$,
  $arcsin alpha(x)$, $alpha(x)$,
  $a r c t g alpha(x)$, $alpha(x)$,
  $1 - cos alpha(x)$, $alpha^2(x) / 2$,
  $e^(alpha(x)) - 1$, $alpha(x)$,
  $ln(1 + alpha(x))$, $alpha(x)$,
  $(1 + alpha(x))^k - 1$, $k dot alpha(x)$
)
]

== Асимптотическое сравнение функций

Пусть $f(x)$ и $g(x)$ — бесконечно малые функции при $x arrow.r a$.

#definition[
  1. *О-малое:* Говорят, что $f$ есть "о-малое" от $g$ ($f = o(g)$), если $f(x) = alpha(x) dot g(x)$, где $alpha(x) arrow.r 0$. 
     (Если $g != 0$, то это эквивалентно $lim_(x arrow.r a) f/g = 0$).
     _Интуиция: $f$ стремится к нулю значительно быстрее, чем $g$._

  2. *О-большое:* Говорят, что $f$ есть "О-большое" от $g$ ($f = O(g)$), если существует константа $C > 0$ такая, что в окрестности $a$: $|f(x)| <= C |g(x)|$.
     _Интуиция: $f$ растет или убывает не быстрее, чем $g$._

  3. *Эквивалентность:* $f$ эквивалентна $g$ ($f tilde g$), если $lim_(x arrow.r a) f/g = 1$.
]

== Лемма о равносильных формулировках

Эта лемма — рабочий инструмент для всех доказательств с $o$-малым.

#note("Лемма об эквивалентности и o-малом")[
  Следующие условия эквивалентны:
  1. $f tilde g$ при $x arrow.r a$.
  2. $f = g + o(g)$ при $x arrow.r a$.
]

#proof[
  - *($1 arrow.r.double 2$):* Если $lim f/g = 1$, то $f/g = 1 + alpha(x)$, где $alpha(x) arrow.r 0$. 
    Умножая на $g$, получаем $f = g + alpha(x)g$. По определению $alpha(x)g = o(g)$.
  - *($2 arrow.r.double 1$):* Если $f = g + o(g)$, то $f = g + alpha(x)g = g(1 + alpha(x))$.
    Тогда $f/g = 1 + alpha(x) arrow.r 1$ при $x arrow.r a$.
]

== Свойства (арифметика) o-малого

При $x arrow.r a$ справедливы следующие символические равенства:

#note("Правила игры", [
  1. $o(f) plus.minus o(f) = o(f)$ (Сумма пренебрежимо малых — всё еще пренебрежимо мала).
  2. $C dot o(f) = o(f)$
  3. $o(f) dot o(g) = o(f dot g)$
  4. $(o(f))^k = o(f^k)$ для $k > 0$.
  5. $o(f + o(f)) = o(f)$
])

#pagebreak()
= Дифференциальное исчисление

== Производная функции

Пусть функция $f(x)$ определена в некоторой окрестности точки $x$. Дадим аргументу приращение $Delta x$ (так, чтобы точка $x + Delta x$ осталась в окрестности). 
Тогда приращение функции: $Delta f = f(x + Delta x) - f(x)$.

#definition[
  *Производной* функции $f(x)$ в точке $x$ называется предел отношения приращения функции к приращению аргумента, когда последнее стремится к нулю:
  $ f'(x) = lim_(Delta x arrow.r 0) (Delta f) / (Delta x) = lim_(Delta x arrow.r 0) (f(x + Delta x) - f(x)) / (Delta x) $
]

== Дифференцируемость

#definition[
  Функция $f(x)$ называется *дифференцируемой* в точке $x$, если её приращение $Delta f$ можно представить в виде:
  $ Delta f = A dot Delta x + o(Delta x) $
  где $A$ — некоторое число, не зависящее от $Delta x$.
]

#note("💡 Суть дифференцируемости", [
  Это значит, что в очень маленьком масштабе график функции практически не отличим от прямой линии. Часть $A dot Delta x$ — это главная линейная часть, а $o(Delta x)$ — это "кривизна", которой можно пренебречь при малых сдвигах.
])

== Дифференциал функции

#definition[
  *Дифференциалом* функции $f(x)$ в точке $x$ называется главная, линейная относительно $Delta x$ часть приращения функции.
  Обозначение: $d f = A dot Delta x$.
]

Поскольку для функции $y = x$ производная равна 1 ($d x = 1 dot Delta x$), то принято писать $d x = Delta x$. Тогда: 
$ d f = f'(x) d x $

#note([В чем разница между $f'(x)$ и $d f$?], [
  - *Производная* $f'(x)$ — это коэффициент (скорость изменения).
  - *Дифференциал* $d f$ — это конкретное (хоть и малое) изменение значения по линейному закону.
  На графике дифференциал — это приращение ординаты *касательной*, а не самой функции.
])

#figure(
  image("pics/diff.png", width: 80%),
  caption: [Дифференциал функции]
) <diff-pic>

#pagebreak()
== Производные и дифференциалы элементарных функций

#align(center)[
#table(
  columns: (1fr, 1.5fr, 1.5fr),
  inset: 10pt,
  align: horizon,
  [*Функция $f(x)$*], [*Производная $f'(x)$*], [*Дифференциал $d f$*],
  $x^n$, $n x^(n-1)$, $n x^(n-1) d x$,
  $e^x$, $e^x$, $e^x d x$,
  $a^x$, $a^x ln a$, $a^x ln a d x$,
  $ln x$, $1/x$, $d x / x$,
  $log_a x$, $1 / (x ln a)$, $d x / (x ln a)$,
  $sin x$, $cos x$, $cos x d x$,
  $cos x$, $-sin x$, $-sin x d x$,
  $tg x$, $1 / cos^2 x$, $d x / cos^2 x$,
  $arcsin x$, $1 / sqrt(1 - x^2)$, $d x / sqrt(1 - x^2)$,
  $a r c t g x$, $1 / (1 + x^2)$, $d x / (1 + x^2)$
)
]

#note([Пример вывода для $sin x$], [
  $ (sin x)' = lim_(Delta x arrow.r 0) (sin(x + Delta x) - sin x) / (Delta x) = lim_(Delta x arrow.r 0) (2 sin(Delta x / 2) cos(x + Delta x / 2)) / (Delta x) $
  Используя первый замечательный предел ($sin(Delta x/2) tilde Delta x/2$):
  $ lim_(Delta x arrow.r 0) (2 dot (Delta x / 2) dot cos(x + Delta x / 2)) / (Delta x) = cos x $
])

#pagebreak()

== Критерий дифференцируемости

#theorem[
  Функция $f(x)$ дифференцируема в точке $x$ тогда и только тогда, когда в этой точке существует конечная производная $f'(x)$.
]

#proof[
  *1. Необходимость ($arrow.r.double$):* 
  Пусть $f$ дифференцируема, т.е. $Delta f = A Delta x + o(Delta x)$. Поделим на $Delta x$:
  $ (Delta f) / (Delta x) = A + (o(Delta x)) / (Delta x) $
  При $Delta x arrow.r 0$ второе слагаемое стремится к 0. Значит, предел отношения существует и равен $A$. Т.е. $f'(x) = A$.

  *2. Достаточность ($arrow.l.double$):* 
  Пусть существует $f'(x) = lim (Delta f / Delta x)$. По свойствам пределов:
  $ (Delta f) / (Delta x) = f'(x) + alpha(Delta x), "где" alpha(Delta x) arrow.r 0 $
  Умножим на $Delta x$: $Delta f = f'(x) Delta x + alpha(Delta x) Delta x$. 
  Так как $alpha(Delta x) Delta x = o(Delta x)$, мы получили определение дифференцируемости.
]

== Необходимое условие дифференцируемости

#theorem[
  Если функция $f(x)$ дифференцируема в точке $x$, то она непрерывна в этой точке.
]

#proof[
  Раз функция дифференцируема, её приращение можно записать как:
  $ Delta f = f'(x) Delta x + o(Delta x) $
  Перейдем к пределу при $Delta x arrow.r 0$:
  $ lim_(Delta x arrow.r 0) Delta f = lim_(Delta x arrow.r 0) (f'(x) Delta x + o(Delta x)) = 0 + 0 = 0 $
  Условие $lim Delta f = 0$ является определением непрерывности функции в точке.
]

#pagebreak()

== Односторонние производные

#definition[
  1. *Производная слева* в точке $x_0$:
  $ f'_-(x_0) = lim_(Delta x arrow.r 0-0) (f(x_0 + Delta x) - f(x_0)) / (Delta x) $
  2. *Производная справа* в точке $x_0$:
  $ f'_+(x_0) = lim_(Delta x arrow.r 0+0) (f(x_0 + Delta x) - f(x_0)) / (Delta x) $
]

== Критерий существования производной

#theorem[
  Функция $f(x)$ имеет производную в точке $x_0$ тогда и только тогда, когда в этой точке существуют обе односторонние производные и они равны между собой:
  $ f'(x_0) = f'_-(x_0) = f'_+(x_0) $
]

#note("Пример: Модуль", [
  Рассмотрим $f(x) = |x|$ в точке $x_0 = 0$.
  - Справа ($Delta x > 0$): $f(Delta x) = Delta x$, значит $f'_+(0) = lim (Delta x / Delta x) = 1$.
  - Слева ($Delta x < 0$): $f(Delta x) = -Delta x$, значит $f'_-(0) = lim (-Delta x / Delta x) = -1$.
  Так как $1 != -1$, производной в нуле не существует. График имеет "излом".
])

=== Визуализация "излома"

#import "@preview/cetz:0.3.2": canvas, draw

#figure(
  canvas({
    import draw: *
    // Оси
    line((-1.5, 0), (1.5, 0), mark: (end: "stealth"), stroke: gray)
    line((0, -0.5), (0, 1.5), mark: (end: "stealth"), stroke: gray)
    
    // График |x|
    line((-1.2, 1.2), (0, 0), (1.2, 1.2), stroke: blue + 1.5pt)
    
    content((0.8, 1.3), [$y = |x|$], fill: white)
    circle((0,0), radius: 0.05, fill: red)
    content((0.5, -0.3), [Точка излома], size: 10pt)
  }),
  caption: [В точке $x=0$ касательную провести нельзя, так как левый и правый наклоны разные.]
)

#pagebreak()

== Геометрический смысл производной

#definition[
  *Касательной* к графику функции в точке $M_0$ называется предельное положение секущей $M_0 M$, когда точка $M$ стремится к $M_0$ вдоль графика.
]

#theorem[
  Производная $f'(x_0)$ равна тангенсу угла наклона $alpha$ касательной, проведенной к графику функции в точке $(x_0, f(x_0))$, к положительному направлению оси $O x$:
  $ f'(x_0) = tg alpha $
]

#note("Уравнение касательной", [
  Если функция дифференцируема в точке $x_0$, то уравнение касательной имеет вид:
  $ y = f(x_0) + f'(x_0)(x - x_0) $
])

== Геометрический смысл дифференциала

Мы знаем, что $Delta f = d f + o(Delta x)$. Посмотрим на это на графике:
- $Delta f$ (приращение функции) — это реальное изменение координаты $y$ на кривой.
- $d f$ (дифференциал) — это изменение координаты $y$ *вдоль линии касательной*.

#figure(
  image("pics/diff.png"),
  caption: [опять diff]
)

== Арифметические свойства производной

Пусть функции $u(x)$ и $v(x)$ дифференцируемы в точке $x$. Тогда:

1. *(Линейность)* $(C u)' = C u'$, $(u + v)' = u' + v'$.
2. *(Правило Лейбница)* $(u v)' = u' v + u v'$.
3. *(Производная частного)* $(u / v)' = (u' v - u v') / v^2$ (при $v != 0$).

#note("Доказательство правила Лейбница (произведение)")[
  $ Delta(u v) = u(x+Delta x) v(x+Delta x) - u(x) v(x) $
  Добавим и вычтем $u(x+Delta x) v(x)$:
  $ Delta(u v) = u(x+Delta x)[v(x+Delta x) - v(x)] + v(x)[u(x+Delta x) - u(x)] \ = u(x+Delta x) Delta v + v(x) Delta u $
  Поделим на $Delta x$ и перейдем к пределу:
  $ (u v)' = lim (u(x+Delta x) (Delta v)/(Delta x) + v(x) (Delta u)/(Delta x)) = u(x) v'(x) + v(x) u'(x) $
]

== Дифференцирование сложной функции

#theorem[
  Пусть функция $y = f(u)$ дифференцируема в точке $u_0 = g(x_0)$, а функция $u = g(x)$ дифференцируема в точке $x_0$. 
  Тогда сложная функция $y = f(g(x))$ дифференцируема в точке $x_0$, и её производная равна:
  $ y'_x = f'_u (u_0) dot g'_x (x_0) $
]

#proof[
  Раз $u = g(x)$ дифференцируема, её приращение: $Delta u = g'(x) Delta x + alpha(Delta x) Delta x$.
  Раз $y = f(u)$ дифференцируема: $Delta y = f'(u) Delta u + beta(Delta u) Delta u$.
  Подставим $Delta u$ в выражение для $Delta y$:
  $ Delta y = f'(u) [g'(x) Delta x + o(Delta x)] + o(Delta u) $
  Поделим на $Delta x$ и перейдем к пределу при $Delta x arrow.r 0$. Заметим, что при $Delta x arrow.r 0$ также и $Delta u arrow.r 0$ (в силу непрерывности).
  $ lim_(Delta x arrow.r 0) (Delta y) / (Delta x) = f'(u) g'(x) $
]

== Дифференцирование обратной функции

#theorem[
  Пусть функция $y = f(x)$ строго монотонна и непрерывна в окрестности точки $x_0$, и существует производная $f'(x_0) != 0$. 
  Тогда обратная функция $x = f^(-1)(y)$ дифференцируема в точке $y_0 = f(x_0)$, и её производная равна:
  $ (f^(-1))' (y_0) = 1 / (f'(x_0)) $
]

#note("Геометрический смысл", [
  Графики прямой и обратной функций симметричны относительно прямой $y=x$. Тангенсы углов их наклона — взаимно обратные величины: $tg beta = 1 / tg alpha$.
])

#note("Пример", [
  Для $y = sin x$ обратная функция $x = arcsin y$. 
  $(arcsin y)' = 1 / (sin x)' = 1 / (cos x) = 1 / sqrt(1 - sin^2 x) = 1 / sqrt(1 - y^2)$.
])

== Дифференцирование параметрически заданной функции

Пусть зависимость $y$ от $x$ задана через параметр $t$:
$ cases(x = phi(t), y = psi(t)) $

#theorem[
  Если функции $phi(t)$ и $psi(t)$ дифференцируемы, причем $phi'(t) != 0$, то производная $y$ по $x$ вычисляется как:
  $ y'_x = (dot(y)) / (dot(x)) = (psi'(t)) / (phi'(t)) $
]

#proof[
  Используя формулу дифференциала: $d y = psi'(t) d t$ и $d x = phi'(t) d t$.
  Тогда производная как отношение дифференциалов:
  $ y'_x = (d y) / (d x) = (psi'(t) d t) / (phi'(t) d t) = (psi'(t)) / (phi'(t)) $
]

== Достаточное условие монотонности функции

#theorem[
  Пусть функция $f(x)$ дифференцируема на интервале $(a, b)$. Тогда:
  1. Если $f'(x) > 0$ для всех $x in (a, b)$, то функция $f(x)$ строго возрастает на этом интервале.
  2. Если $f'(x) < 0$ для всех $x in (a, b)$, то функция $f(x)$ строго убывает на этом интервале.
]

#proof[
  Воспользуемся теоремой Лагранжа (которую мы разберем чуть позже, но она тут база). 
  Для любых $x_1, x_2 in (a, b)$ таких, что $x_1 < x_2$:
  $ f(x_2) - f(x_1) = f'(c)(x_2 - x_1), quad "где" c in (x_1, x_2) $
  Так как $(x_2 - x_1) > 0$, то знак разности $f(x_2) - f(x_1)$ полностью совпадает со знаком производной $f'(c)$. 
  Если $f'(x) > 0$, то $f(x_2) > f(x_1)$ — функция возрастает.
]

#pagebreak()

== Теорема Ферма

#theorem[
  Пусть функция $f(x)$ определена в некоторой окрестности точки $c$ и имеет в этой точке локальный экстремум (максимум или минимум). Если в точке $c$ существует производная $f'(c)$, то она равна нулю:
  $ f'(c) = 0 $
]

#proof[
  Пусть для определенности точка $c$ является точкой локального максимума. 
  Тогда по определению максимума существует такая окрестность точки $c$, что для всех $x$ из этой окрестности выполняется:
  $ f(x) <= f(c) quad arrow.r.double quad f(x) - f(c) <= 0 $
  
  Рассмотрим производную как предел отношения приращений. Так как производная существует, она равна односторонним пределам:
  
  1. *Справа ($Delta x > 0$):*
     Поскольку $f(c + Delta x) - f(c) <= 0$, а $Delta x > 0$, то:
     $ (f(c + Delta x) - f(c)) / (Delta x) <= 0 $
     Переходя к пределу при $Delta x arrow.r 0+0$, получаем: $f'_+(c) <= 0$.

  2. *Слева ($Delta x < 0$):*
     Поскольку $f(c + Delta x) - f(c) <= 0$, а $Delta x < 0$, то знак дроби меняется:
     $ (f(c + Delta x) - f(c)) / (Delta x) >= 0 $
     Переходя к пределу при $Delta x arrow.r 0-0$, получаем: $f'_-(c) >= 0$.

  3. *Итог:*
     Так как производная $f'(c)$ существует, то $f'_-(c) = f'_+(c) = f'(c)$. 
     Единственное число, которое одновременно $<= 0$ и $>= 0$ — это ноль.
     Значит, $f'(c) = 0$.
]

#note("⚠️ Важное замечание", [
  Теорема Ферма — это *необходимое*, но не *достаточное* условие. 
  Если производная равна нулю, это не гарантирует экстремум. 
  Классический пример: $f(x) = x^3$. В точке $x=0$ производная $f'(0) = 0$, но там нет ни максимума, ни минимума (это точка перегиба).
])

#pagebreak()

== Теорема Дарбу

#theorem[
  Пусть функция $f(x)$ дифференцируема на отрезке $[a, b]$, и пусть $f'(a) = A$, $f'(b) = B$. Тогда производная $f'(x)$ принимает любое промежуточное значение между $A$ и $B$.
]

#proof[
  Пусть для определенности $A < C < B$. Рассмотрим вспомогательную функцию:
  $ g(x) = f(x) - C x $
  
  1. Функция $g(x)$ дифференцируема на $[a, b]$ (как разность дифференцируемых функций), а значит, она непрерывна на $[a, b]$.
  2. По **второй теореме Вейерштрасса**, непрерывная на отрезке функция достигает своего минимума в некоторой точке $c in [a, b]$.
  3. Проверим производные $g(x)$ на концах отрезка:
     - $g'(a) = f'(a) - C = A - C < 0$. Раз производная в точке $a$ отрицательна, функция убывает вправо от $a$. Значит, минимум не может быть в точке $a$.
     - $g'(b) = f'(b) - C = B - C > 0$. Раз производная в точке $b$ положительна, функция возрастает слева от $b$. Значит, минимум не может быть в точке $b$.
  4. Следовательно, точка минимума $c$ обязана лежать внутри интервала: $c in (a, b)$.
  5. По **теореме Ферма**, в точке локального экстремума (минимума) внутри интервала производная равна нулю:
     $ g'(c) = 0 quad arrow.r.double quad f'(c) - C = 0 quad arrow.r.double quad f'(c) = C $
  Теорема доказана.
]

#note("💡 В чем подвох?", [
  Эта теорема *не означает*, что $f'(x)$ непрерывна. Существуют функции (например, $x^2 sin(1/x)$), производная которых разрывна, но при этом она всё равно "пробегает" все значения, не перепрыгивая их. Разрывы у производной могут быть только второго рода (бесконечные или осцилляции).
])

#pagebreak()

== Теорема Ролля

#theorem[
  Пусть функция $f(x)$ удовлетворяет трем условиям:
  1. Непрерывна на отрезке $[a, b]$.
  2. Дифференцируема на интервале $(a, b)$.
  3. На концах отрезка принимает равные значения: $f(a) = f(b)$.
  
  Тогда существует хотя бы одна точка $c in (a, b)$, такая что $f'(c) = 0$.
]

#proof[
  Так как функция $f(x)$ непрерывна на отрезке $[a, b]$, по **второй теореме Вейерштрасса** она достигает на нем своего максимума $M$ и минимума $m$.

  Рассмотрим два случая:
  1. *Случай $M = m$:* 
     Это значит, что функция постоянна на всем отрезке ($f(x) = C$). Производная константы равна нулю в любой точке интервала. Любая точка может быть взята в качестве $c$.

  2. *Случай $M > m$:*
     Так как $f(a) = f(b)$, то хотя бы одно из этих экстремальных значений (либо максимум, либо минимум) достигается **внутри** интервала $(a, b)$. 
     Пусть, например, $f(c) = M$, где $c in (a, b)$. 
     По условию, функция дифференцируема в точке $c$. Тогда по **теореме Ферма**, в точке локального экстремума производная обязана быть равной нулю:
     $ f'(c) = 0 $
  Теорема доказана.
]

#note("💡 Важность условий", [
  Если убрать хотя бы одно условие, теорема перестанет работать:
  - Без *непрерывности*: $f(x) = x$ на $[0, 1)$ и $f(1)=0$. $f(0)=f(1)$, но производная везде 1.
  - Без *дифференцируемости*: $f(x) = |x|$ на $[-1, 1]$. $f(-1)=f(1)$, но в "изломе" производной нет, и она нигде не ноль.
])

#figure(
  image("pics/rolle.png", width: 80%),
  caption: "Теорема Ролля"
) <rolles-theorem>

== Теорема Лагранжа

#theorem[
  Пусть функция $f(x)$ удовлетворяет двум условиям:
  1. Непрерывна на отрезке $[a, b]$.
  2. Дифференцируема на интервале $(a, b)$.
  
  Тогда существует хотя бы одна точка $c in (a, b)$, такая что:
  $ f(b) - f(a) = f'(c)(b - a) $
]

#proof[
  Сведем доказательство к теореме Ролля. Для этого введем вспомогательную функцию $g(x)$, которая представляет собой разность между функцией и хордой, соединяющей точки $(a, f(a))$ и $(b, f(b))$.
  
  Уравнение хорды: $y = f(a) + (f(b) - f(a)) / (b - a) (x - a)$.
  Рассмотрим функцию:
  $ g(x) = f(x) - f(a) - (f(b) - f(a)) / (b - a) (x - a) $
  
  1. *Непрерывность и дифференцируемость:* $g(x)$ наследует эти свойства от $f(x)$.
  2. *Значения на концах:*
     - $g(a) = f(a) - f(a) - 0 = 0$.
     - $g(b) = f(b) - f(a) - (f(b) - f(a)) / (b - a) (b - a) = f(b) - f(a) - (f(b) - f(a)) = 0$.
  
  Функция $g(x)$ удовлетворяет всем условиям теоремы Ролля. Следовательно, существует точка $c in (a, b)$, такая что $g'(c) = 0$.
  Вычислим производную:
  $ g'(x) = f'(x) - (f(b) - f(a)) / (b - a) $
  Подставив $c$:
  $ f'(c) - (f(b) - f(a)) / (b - a) = 0 quad arrow.r.double quad f'(c) = (f(b) - f(a)) / (b - a) $
  Домножив на $(b - a)$, получаем требуемую формулу.
]

#note("💡 Почему это важно?", [
  Эта теорема связывает *значения* функции с её *производной*. 
  Она позволяет оценивать приращение функции: если мы знаем, что производная ограничена ($|f'| <= M$), то функция не может измениться слишком сильно: $|f(b) - f(a)| <= M |b - a|$. 
])

#figure(
  image("pics/lagrange.png", width: 60%),
  caption: [Визуализация Теоремы Лагранжа]
) <lagrange-th>

#pagebreak()

== Теорема Коши

#theorem[
  Пусть функции $f(x)$ и $g(x)$ удовлетворяют следующим условиям:
  1. Непрерывны на отрезке $[a, b]$.
  2. Дифференцируемы на интервале $(a, b)$.
  3. Производная $g'(x) != 0$ для всех $x in (a, b)$.
  
  Тогда существует хотя бы одна точка $c in (a, b)$, такая что:
  $ (f(b) - f(a)) / (g(b) - g(a)) = (f'(c)) / (g'(c)) $
]

#proof[
  1. Сначала заметим, что из условия $g'(x) != 0$ и теоремы Ролля следует, что $g(b) != g(a)$ (иначе нашлась бы точка, где производная ноль). Значит, деление в левой части формулы корректно.
  
  2. Введем вспомогательную функцию $F(x)$, аналогично тому, как мы это делали в теореме Лагранжа:
  $ F(x) = f(x) - f(a) - (f(b) - f(a)) / (g(b) - g(a)) (g(x) - g(a)) $
  
  3. Проверим условия теоремы Ролля для $F(x)$:
     - $F(x)$ непрерывна и дифференцируема (как линейная комбинация $f$ и $g$).
     - $F(a) = f(a) - f(a) - (dots)(g(a) - g(a)) = 0$.
     - $F(b) = f(b) - f(a) - (f(b) - f(a)) / (g(b) - g(a)) (g(b) - g(a)) = 0$.
     
  4. По теореме Ролля существует точка $c in (a, b)$, такая что $F'(c) = 0$.
  
  5. Вычислим производную:
  $ F'(x) = f'(x) - (f(b) - f(a)) / (g(b) - g(a)) g'(x) $
  Подставим $c$ и приравняем к нулю:
  $ f'(c) = (f(b) - f(a)) / (g(b) - g(a)) g'(c) $
  Так как $g'(c) != 0$, перенесем его в левую часть. Получаем искомую формулу.
]

== Правило Лопиталя

#theorem[
  Пусть функции $f(x)$ и $g(x)$ дифференцируемы в проколотой окрестности точки $a$. Если:
  1. $lim_(x arrow.r a) f(x) = 0$ и $lim_(x arrow.r a) g(x) = 0$ (или оба предела равны $infinity$);
  2. $g'(x) != 0$ в этой проколотой окрестности;
  3. Существует предел отношения производных $lim_(x arrow.r a) (f'(x)) / (g'(x)) = A$ (конечный или бесконечный);
  
  Тогда существует предел отношения функций, и он равен $A$:
  $ lim_(x arrow.r a) (f(x)) / (g(x)) = lim_(x arrow.r a) (f'(x)) / (g'(x)) $
]

#note("Доказательство для случая $0/0$")[
  Доопределим функции в точке $a$ так, чтобы они стали непрерывными: $f(a) = 0, g(a) = 0$.
  Рассмотрим произвольную точку $x$ из окрестности $a$. На отрезке $[a, x]$ функции удовлетворяют всем условиям *теоремы Коши*.
  Согласно теореме Коши, существует точка $c$ между $a$ и $x$ такая, что:
  $ (f(x) - f(a)) / (g(x) - g(a)) = (f'(c)) / (g'(c)) $
  Так как $f(a) = 0$ и $g(a) = 0$, формула упрощается:
  $ (f(x)) / (g(x)) = (f'(c)) / (g'(c)) $
  Перейдем к пределу при $x arrow.r a$. Так как $c$ зажата между $a$ и $x$, то при $x arrow.r a$ точка $c$ также стремится к $a$ ($c arrow.r a$).
  Значит:
  $ lim_(x arrow.r a) (f(x)) / (g(x)) = lim_(c arrow.r a) (f'(c)) / (g'(c)) = A $
]

#note("⚠️ Важные моменты", [
  1. *Не забывай проверять условия!* Если предел не является неопределенностью $0/0$ или $infinity/infinity$, правило Лопиталя даст неверный ответ.
  2. *Цикличность:* Иногда правило Лопиталя можно применять несколько раз подряд, если неопределенность сохраняется.
  3. *Обратное неверно:* Если предел отношения функций существует, это не значит, что предел отношения производных тоже существует. Пример: $lim_(x arrow.r infinity) (x + sin x) / x = 1$, но предел производных $(1 + cos x) / 1$ не существует.
])

#note("💡 Лайфхак для других неопределенностей", [
  - $0 dot infinity$ $arrow.r$ превращаем в $f / (1/g)$ (тип $0/0$) или $g / (1/f)$ (тип $infinity/infinity$).
  - $infinity - infinity$ $arrow.r$ приводим к общему знаменателю.
  - $0^0, 1^infinity, infinity^0$ $arrow.r$ используем тождество $f^g = e^(g ln f)$.
])

= ВСЬО